(self.webpackChunkassignments_frontend=self.webpackChunkassignments_frontend||[]).push([["87201"],{857667:function(e){var t;"undefined"!=typeof self&&self,e.exports=(()=>{var e,t,n={933:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o,a,l=s(e),u=l[0],c=l[1],d=new i(3*(u+(n=c))/4-n),f=0,p=c>0?u-4:u;for(a=0;a<p;a+=4)o=r[e.charCodeAt(a)]<<18|r[e.charCodeAt(a+1)]<<12|r[e.charCodeAt(a+2)]<<6|r[e.charCodeAt(a+3)],d[f++]=o>>16&255,d[f++]=o>>8&255,d[f++]=255&o;return 2===c&&(o=r[e.charCodeAt(a)]<<2|r[e.charCodeAt(a+1)]>>4,d[f++]=255&o),1===c&&(o=r[e.charCodeAt(a)]<<10|r[e.charCodeAt(a+1)]<<4|r[e.charCodeAt(a+2)]>>2,d[f++]=o>>8&255,d[f++]=255&o),d},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=0,s=r-i;a<s;a+=16383)o.push(function(e,t,r){for(var i,o=[],a=t;a<r;a+=3)o.push(n[(i=(e[a]<<16&0xff0000)+(e[a+1]<<8&65280)+(255&e[a+2]))>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return o.join("")}(e,a,a+16383>s?s:a+16383));return 1===i?o.push(n[(t=e[r-1])>>2]+n[t<<4&63]+"=="):2===i&&o.push(n[(t=(e[r-2]<<8)+e[r-1])>>10]+n[t>>4&63]+n[t<<2&63]+"="),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=o[a],r[o.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return -1===n&&(n=t),[n,n===t?0:4-n%4]}r[45]=62,r[95]=63},815:(e,t,n)=>{let r;t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))}),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=void 0),e},t.useColors=function(){return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),r=!1,t.destroy=()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))},t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(530)(t);let{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},530:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,o,a=null;function s(...e){if(!s.enabled)return;let r=Number(new Date);s.diff=r-(n||r),s.prev=n,s.curr=r,n=r,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,r)=>{if("%%"===n)return"%";i++;let o=t.formatters[r];if("function"==typeof o){let t=e[i];n=o.call(s,t),e.splice(i,1),i--}return n}),t.formatArgs.call(s,e),(s.log||t.log).apply(s,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){let r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){let e=[...t.names.map(i),...t.skips.map(i).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];let r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.slice(1)+"$")):t.names.push(RegExp("^"+e+"$")))},t.enabled=function(e){let n,r;if("*"===e[e.length-1])return!0;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(821),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},821:e=>{function t(e,t,n,r){return Math.round(e/n)+" "+r+(t>=1.5*n?"s":"")}e.exports=function(e,n){n=n||{};var r,i,o=typeof e;if("string"===o&&e.length>0){var a=e;if(!((a=String(a)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(a);if(s){var l=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*l;case"weeks":case"week":case"w":return 6048e5*l;case"days":case"day":case"d":return 864e5*l;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*l;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*l;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*l;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}return}if("number"===o&&isFinite(e))return n.long?(r=Math.abs(e))>=864e5?t(e,r,864e5,"day"):r>=36e5?t(e,r,36e5,"hour"):r>=6e4?t(e,r,6e4,"minute"):r>=1e3?t(e,r,1e3,"second"):e+" ms":(i=Math.abs(e))>=864e5?Math.round(e/864e5)+"d":i>=36e5?Math.round(e/36e5)+"h":i>=6e4?Math.round(e/6e4)+"m":i>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(n,r){if(1&r&&(n=this(n)),8&r||"object"==typeof n&&n&&(4&r&&n.__esModule||16&r&&"function"==typeof n.then))return n;var o=Object.create(null);i.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>a[e]=()=>n[e]);return a.default=()=>n,i.d(o,a),o},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{"use strict";let e,t,n,r,a,s,l,u,c,d;i.r(o),i.d(o,{ActionObjectType:()=>nL,AppId:()=>ih,ChannelType:()=>eR,ChildAppWindow:()=>cq,DialogDimension:()=>eO,EduType:()=>nz,EmailAddress:()=>u6,ErrorCode:()=>nH,FileOpenPreference:()=>nU,FrameContexts:()=>eI,HostClientType:()=>eA,HostName:()=>eE,LiveShareHost:()=>fZ,NotificationTypes:()=>eU,ParentAppWindow:()=>c$,SecondaryM365ContentIdName:()=>n_,TaskModuleDimension:()=>eO,TeamType:()=>eT,UUID:()=>rM,UserSettingTypes:()=>e_,UserTeamRole:()=>eP,ValidatedSafeString:()=>im,ViewerActionTypes:()=>eL,activateChildProxyingCommunication:()=>r1,app:()=>tA,appEntity:()=>t3,appInitialization:()=>nk,appInstallDialog:()=>nr,authentication:()=>nn,barCode:()=>no,calendar:()=>nh,call:()=>nF,chat:()=>na,clipboard:()=>ns,conversations:()=>tV,copilot:()=>tW,dialog:()=>tF,enablePrintCapability:()=>fv,executeDeepLink:()=>fN,externalAppAuthentication:()=>tz,externalAppAuthenticationForCEA:()=>tq,externalAppCardActions:()=>t$,externalAppCardActionsForCEA:()=>tG,externalAppCardActionsForDA:()=>tJ,externalAppCommands:()=>tK,files:()=>tQ,geoLocation:()=>nc,getAdaptiveCardSchemaVersion:()=>cz,getContext:()=>fy,getCurrentFeatureFlagsState:()=>r6,getMruTabInstances:()=>fk,getTabInstances:()=>fF,hostEntity:()=>ne,initialize:()=>fh,initializeWithFrameContext:()=>fD,liveShare:()=>nD,location:()=>nf,logs:()=>tH,mail:()=>nw,marketplace:()=>n$,media:()=>ni,meeting:()=>ng,meetingRoom:()=>tZ,menus:()=>tk,messageChannels:()=>tX,monetization:()=>nm,navigateBack:()=>fH,navigateCrossDomain:()=>f_,navigateToTab:()=>fL,nestedAppAuth:()=>nl,nestedAppAuthBridge:()=>tY,notifications:()=>t0,openFilePreview:()=>sS,otherAppStateChange:()=>t1,overwriteFeatureFlagsState:()=>r8,pages:()=>t_,people:()=>nC,print:()=>fw,profile:()=>nb,registerAppButtonClickHandler:()=>fS,registerAppButtonHoverEnterHandler:()=>fA,registerAppButtonHoverLeaveHandler:()=>fE,registerBackButtonHandler:()=>fI,registerBeforeUnloadHandler:()=>fP,registerChangeSettingsHandler:()=>fR,registerCustomHandler:()=>sC,registerFocusEnterHandler:()=>fO,registerFullScreenHandler:()=>fb,registerOnLoadHandler:()=>fT,registerOnThemeChangeHandler:()=>fC,registerUserSettingsChangeHandler:()=>sb,remoteCamera:()=>t2,returnFocus:()=>fU,search:()=>nS,secondaryBrowser:()=>nd,sendCustomEvent:()=>sy,sendCustomMessage:()=>sw,setFeatureFlagsState:()=>r5,setFrameContext:()=>fx,settings:()=>nN,shareDeepLink:()=>fM,sharing:()=>nE,stageView:()=>nT,store:()=>nt,tasks:()=>nx,teams:()=>t8,teamsCore:()=>ny,thirdPartyCloudStorage:()=>nM,uploadCustomApp:()=>sv,version:()=>rY,videoEffects:()=>t4,videoEffectsEx:()=>t9,visualMedia:()=>nO,webStorage:()=>nR});var f,p,g,m,h,v,w,y,C,b,S,A,E,I,T,P,O,R,F,k,M,N,x,D,U,L,_,H,V,B,j,W,z,q,$,G,J,K,Q,Z,X,Y,ee,et,en,er,ei,eo,ea,es,el,eu,ec,ed,ef,ep,eg,em,eh,ev,ew,ey,eC,eb,eS,eA,eE,eI,eT,eP,eO,eR,eF,ek,eM,eN,ex,eD,eU,eL,e_,eH,eV,eB,ej,eW,ez,eq,e$,eG,eJ,eK,eQ,eZ,eX,eY,e0,e1,e2,e3,e6,e5,e8,e4,e9,e7,te,tt,tn,tr,ti,to,ta,ts,tl,tu,tc,td,tf,tp,tg,tm,th,tv,tw,ty,tC={};i.r(tC),i.d(tC,{_clearTelemetryPort:()=>ib,getTelemetryPort:()=>iy,isSupported:()=>iC});var tb={};i.r(tb),i.d(tb,{_clearDataLayerPort:()=>iI,getDataLayerPort:()=>iA,isSupported:()=>iE});var tS={};i.r(tS),i.d(tS,{registerBeforeSuspendOrTerminateHandler:()=>iT,registerOnResumeHandler:()=>iP});var tA={};i.r(tA),i.d(tA,{ExpectedFailureReason:()=>ek,FailedReason:()=>eF,Messages:()=>iR,_initialize:()=>iN,_uninitialize:()=>ix,getContext:()=>iD,getFrameContext:()=>ik,initialize:()=>iM,isInitialized:()=>iF,lifecycle:()=>tS,notifyAppLoaded:()=>iU,notifyExpectedFailure:()=>iH,notifyFailure:()=>i_,notifySuccess:()=>iL,openLink:()=>ij,registerHostToAppPerformanceMetricsHandler:()=>iB,registerOnThemeChangeHandler:()=>iV});var tE={};i.r(tE),i.d(tE,{isSupported:()=>iz,resize:()=>iW});var tI={};i.r(tI),i.d(tI,{isSupported:()=>i$,open:()=>iq});var tT={};i.r(tT),i.d(tT,{isSupported:()=>iQ,registerOnMessageFromParent:()=>iK,sendMessageToDialog:()=>iJ,sendMessageToParentFromDialog:()=>iG});var tP={};i.r(tP),i.d(tP,{bot:()=>tI,getDialogInfoFromBotUrlDialogInfo:()=>i1,getDialogInfoFromUrlDialogInfo:()=>i0,isSupported:()=>iY,open:()=>iZ,parentCommunication:()=>tT,submit:()=>iX});var tO={};i.r(tO),i.d(tO,{isSupported:()=>ot,open:()=>oe});var tR={};i.r(tR),i.d(tR,{bot:()=>tO,isSupported:()=>or,open:()=>on});var tF={};i.r(tF),i.d(tF,{adaptiveCard:()=>tR,initialize:()=>oi,isSupported:()=>oo,update:()=>tE,url:()=>tP});var tk={};i.r(tk),i.d(tk,{DisplayMode:()=>eM,MenuItem:()=>oa,MenuListType:()=>eN,initialize:()=>os,isSupported:()=>og,setNavBarMenu:()=>oc,setUpViews:()=>ol,showActionMenu:()=>of});var tM={};i.r(tM),i.d(tM,{initialize:()=>om,isSupported:()=>oP,registerChangeConfigHandler:()=>oA,registerOnRemoveHandler:()=>oC,registerOnRemoveHandlerHelper:()=>ob,registerOnSaveHandler:()=>ow,registerOnSaveHandlerHelper:()=>oy,setConfig:()=>ov,setValidityState:()=>oh});var tN={};i.r(tN),i.d(tN,{isSupported:()=>oK,onClick:()=>o$,onHoverEnter:()=>oG,onHoverLeave:()=>oJ});var tx={};i.r(tx),i.d(tx,{_initialize:()=>oQ,isSupported:()=>o0,navigateBack:()=>oZ,registerBackButtonHandler:()=>oX,registerBackButtonHandlerHelper:()=>oY});var tD={};i.r(tD),i.d(tD,{isSupported:()=>o3,navigateTo:()=>o1,navigateToDefaultPage:()=>o2});var tU={};i.r(tU),i.d(tU,{enterFullscreen:()=>o6,exitFullscreen:()=>o5,isSupported:()=>o8});var tL={};i.r(tL),i.d(tL,{getMruTabInstances:()=>o7,getTabInstances:()=>o9,isSupported:()=>ae,navigateToTab:()=>o4});var t_={};i.r(t_),i.d(t_,{EnterFocusType:()=>ex,ReturnFocusType:()=>eD,appButton:()=>tN,backStack:()=>tx,config:()=>tM,currentApp:()=>tD,fullTrust:()=>tU,getConfig:()=>ao,initializeWithFrameContext:()=>ai,isSupported:()=>ac,navigateCrossDomain:()=>aa,navigateToApp:()=>as,registerFocusEnterHandler:()=>an,registerFullScreenHandler:()=>au,returnFocus:()=>at,setCurrentFrame:()=>ar,shareDeepLink:()=>al,tabs:()=>tL});var tH={};i.r(tH),i.d(tH,{isSupported:()=>sh,registerGetLogHandler:()=>sm});var tV={};i.r(tV),i.d(tV,{closeConversation:()=>sE,getChatMembers:()=>sI,isSupported:()=>sT,openConversation:()=>sA});var tB={};i.r(tB),i.d(tB,{isSupported:()=>sO,sendCustomTelemetryData:()=>sR});var tj={};i.r(tj),i.d(tj,{getEligibilityInfo:()=>sM,isSupported:()=>sk});var tW={};i.r(tW),i.d(tW,{customTelemetry:()=>tB,eligibility:()=>tj});var tz={};i.r(tz),i.d(tz,{ActionExecuteInvokeRequestType:()=>sD,ActionExecuteResponseHandler:()=>sU,InvokeErrorCode:()=>eB,InvokeResponseType:()=>eV,OriginalRequestType:()=>eH,SerializableActionExecuteInvokeRequest:()=>sN,authenticateAndResendRequest:()=>sV,authenticateWithOauth2:()=>sW,authenticateWithPowerPlatformConnectorPlugins:()=>sz,authenticateWithSSO:()=>sB,authenticateWithSSOAndResendRequest:()=>sj,isActionExecuteResponse:()=>sx,isInvokeError:()=>sL,isSupported:()=>sq,validateActionExecuteInvokeRequest:()=>sH});var tq={};i.r(tq),i.d(tq,{authenticateAndResendRequest:()=>sK,authenticateWithOauth:()=>sJ,authenticateWithSSO:()=>sG,authenticateWithSSOAndResendRequest:()=>sQ,isSupported:()=>sZ,validateInput:()=>sX});var t$={};i.r(t$),i.d(t$,{ActionOpenUrlErrorCode:()=>eW,ActionOpenUrlType:()=>ej,isSupported:()=>s1,processActionOpenUrl:()=>s0,processActionSubmit:()=>sY});var tG={};i.r(tG),i.d(tG,{isSupported:()=>s5,processActionOpenUrl:()=>s3,processActionSubmit:()=>s6});var tJ={};i.r(tJ),i.d(tJ,{SerializableActionOpenUrlDialogInfo:()=>s7,isSupported:()=>s9,processActionOpenUrlDialog:()=>s4});var tK={};i.r(tK),i.d(tK,{isSupported:()=>lt,processActionCommand:()=>le});var tQ={};i.r(tQ),i.d(tQ,{CloudStorageProvider:()=>eq,CloudStorageProviderFileAction:()=>eQ,CloudStorageProviderType:()=>e$,DocumentLibraryAccessType:()=>eJ,FileDownloadStatus:()=>eK,SpecialDocumentLibraryType:()=>eG,addCloudStorageFolder:()=>lr,addCloudStorageProvider:()=>ld,addCloudStorageProviderFile:()=>lp,copyMoveFiles:()=>ll,deleteCloudStorageFolder:()=>li,deleteCloudStorageProviderFile:()=>lm,downloadCloudStorageProviderFile:()=>lh,getCloudStorageFolderContents:()=>lo,getCloudStorageFolders:()=>ln,getExternalProviders:()=>ls,getFileDownloads:()=>lu,openCloudStorageFile:()=>la,openDownloadFolder:()=>lc,registerCloudStorageProviderContentChangeHandler:()=>ly,registerCloudStorageProviderListChangeHandler:()=>lw,removeCloudStorageProvider:()=>lf,renameCloudStorageProviderFile:()=>lg,uploadCloudStorageProviderFile:()=>lv});var tZ={};i.r(tZ),i.d(tZ,{getPairedMeetingRoomInfo:()=>lb,isSupported:()=>lI,registerMeetingRoomCapabilitiesUpdateHandler:()=>lA,registerMeetingRoomStatesUpdateHandler:()=>lE,sendCommandToPairedMeetingRoom:()=>lS});var tX={};i.r(tX),i.d(tX,{dataLayer:()=>tb,isSupported:()=>lT,telemetry:()=>tC});var tY={};i.r(tY),i.d(tY,{initialize:()=>lk,version:()=>lP});var t0={};i.r(t0),i.d(t0,{isSupported:()=>lD,showNotification:()=>lx});var t1={};i.r(t1),i.d(t1,{isSupported:()=>lH,notifyInstallCompleted:()=>l_,registerAppInstallationHandler:()=>lU,unregisterAppInstallationHandler:()=>lL});var t2={};i.r(t2),i.d(t2,{ControlCommand:()=>eZ,ErrorReason:()=>eX,SessionTerminatedReason:()=>eY,getCapableParticipants:()=>lV,isSupported:()=>lJ,registerOnCapableParticipantsChangeHandler:()=>lz,registerOnDeviceStateChangeHandler:()=>l$,registerOnErrorHandler:()=>lq,registerOnSessionStatusChangeHandler:()=>lG,requestControl:()=>lB,sendControlCommand:()=>lj,terminateSession:()=>lW});var t3={};i.r(t3),i.d(t3,{isSupported:()=>lQ,selectAppEntity:()=>lK});var t6={};i.r(t6),i.d(t6,{getUserJoinedTeams:()=>lZ,isSupported:()=>lX});var t5={};i.r(t5),i.d(t5,{getConfigSetting:()=>lY,isSupported:()=>l0,joinedTeams:()=>t6});var t8={};i.r(t8),i.d(t8,{ChannelType:()=>e0,fullTrust:()=>t5,getTeamChannels:()=>l1,isSupported:()=>l3,refreshSiteUrl:()=>l2});var t4={};i.r(t4),i.d(t4,{EffectChangeType:()=>e2,EffectFailureReason:()=>e3,VideoFrameFormat:()=>e1,isSupported:()=>ui,notifySelectedVideoEffectChanged:()=>ut,registerForVideoEffect:()=>un,registerForVideoFrame:()=>ue});var t9={};i.r(t9),i.d(t9,{ErrorLevel:()=>e6,frameProcessingTimeoutInMs:()=>uw,isSupported:()=>uI,notifyFatalError:()=>uP,notifySelectedVideoEffectChanged:()=>uS,registerForVideoEffect:()=>uA,registerForVideoFrame:()=>uC,updatePersonalizedEffects:()=>uE});var t7={};i.r(t7),i.d(t7,{addAndConfigure:()=>ux,getAll:()=>uD,isSupported:()=>uH,reconfigure:()=>uU,remove:()=>u_,rename:()=>uL});var ne={};i.r(ne),i.d(ne,{AppTypes:()=>e5,isSupported:()=>uj,tab:()=>t7});var nt={};i.r(nt),i.d(nt,{isSupported:()=>uJ,openAppDetail:()=>uq,openFullStore:()=>uz,openInContextStore:()=>u$,openSpecificStore:()=>uG});var nn={};i.r(nn),i.d(nn,{DataResidency:()=>e8,authenticate:()=>uX,getAuthToken:()=>uY,getUser:()=>u0,notifyFailure:()=>u2,notifySuccess:()=>u1,registerAuthenticationHandlers:()=>uZ});var nr={};i.r(nr),i.d(nr,{isSupported:()=>u9,openAppInstallDialog:()=>u4});var ni={};i.r(ni),i.d(ni,{CameraStartMode:()=>e7,File:()=>ce,FileFormat:()=>e4,ImageOutputFormats:()=>tr,ImageUriType:()=>tn,Media:()=>co,MediaControllerEvent:()=>e9,MediaType:()=>tt,Source:()=>te,VideoController:()=>cs,captureImage:()=>ct,hasPermission:()=>cn,requestPermission:()=>cr,scanBarCode:()=>cc,selectMedia:()=>cl,viewImages:()=>cu});var no={};i.r(no),i.d(no,{hasPermission:()=>cm,isSupported:()=>cv,requestPermission:()=>ch,scanBarCode:()=>cg});var na={};i.r(na),i.d(na,{isSupported:()=>cb,openChat:()=>cw,openGroupChat:()=>cC});var ns={};i.r(ns),i.d(ns,{isSupported:()=>cI,read:()=>cE,write:()=>cA});var nl={};i.r(nl),i.d(nl,{addNAATrustedOrigins:()=>cM,canParentManageNAATrustedOrigins:()=>cF,deleteNAATrustedOrigins:()=>cN,getParentOrigin:()=>cR,isDeeplyNestedAuthSupported:()=>ck,isNAAChannelRecommended:()=>cO});var nu={};i.r(nu),i.d(nu,{chooseLocation:()=>cL,isSupported:()=>cH,showLocation:()=>c_});var nc={};i.r(nc),i.d(nc,{getCurrentLocation:()=>cV,hasPermission:()=>cB,isSupported:()=>cW,map:()=>nu,requestPermission:()=>cj});var nd={};i.r(nd),i.d(nd,{isSupported:()=>cJ,open:()=>cG});var nf={};i.r(nf),i.d(nf,{getLocation:()=>cK,isSupported:()=>cZ,showLocation:()=>cQ});var np={};i.r(np),i.d(np,{setOptions:()=>cX});var ng={};i.r(ng),i.d(ng,{CallType:()=>tl,EventActionSource:()=>tc,MeetingReactionType:()=>ta,MeetingType:()=>ts,SharingProtocol:()=>tu,appShareButton:()=>np,getAppContentStageSharingCapabilities:()=>de,getAppContentStageSharingState:()=>dn,getAuthenticationTokenForAnonymousUser:()=>c6,getIncomingClientAudioState:()=>c0,getLiveStreamState:()=>c5,getMeetingDetails:()=>c2,getMeetingDetailsVerbose:()=>c3,joinMeeting:()=>ds,registerLiveStreamChangedHandler:()=>c9,registerMeetingReactionReceivedHandler:()=>da,registerRaiseHandStateChangedHandler:()=>di,registerSpeakingStateChangeHandler:()=>dr,requestAppAudioHandling:()=>dl,requestStartLiveStreaming:()=>c8,requestStopLiveStreaming:()=>c4,shareAppContentToStage:()=>c7,stopSharingAppContentToStage:()=>dt,toggleIncomingClientAudio:()=>c1,updateMicState:()=>du});var nm={};i.r(nm),i.d(nm,{isSupported:()=>df,openPurchaseExperience:()=>dd});var nh={};i.r(nh),i.d(nh,{composeMeeting:()=>dg,isSupported:()=>dm,openCalendarItem:()=>dp});var nv={};i.r(nv),i.d(nv,{composeMailWithHandoff:()=>dv,isSupported:()=>dw});var nw={};i.r(nw),i.d(nw,{ComposeMailType:()=>td,composeMail:()=>db,handoff:()=>nv,isSupported:()=>dS,openMailItem:()=>dC});var ny={};i.r(ny),i.d(ny,{enablePrintCapability:()=>dA,isSupported:()=>dR,print:()=>dE,registerBeforeUnloadHandler:()=>dP,registerBeforeUnloadHandlerHelper:()=>dO,registerOnLoadHandler:()=>dI,registerOnLoadHandlerHelper:()=>dT});var nC={};i.r(nC),i.d(nC,{isSupported:()=>dM,selectPeople:()=>dF});var nb={};i.r(nb),i.d(nb,{isSupported:()=>dx,showProfile:()=>dN});var nS={};i.r(nS),i.d(nS,{closeSearch:()=>dB,isSupported:()=>dV,registerHandlers:()=>d_,unregisterHandlers:()=>dH});var nA={};i.r(nA),i.d(nA,{getContent:()=>dj,isSupported:()=>dW});var nE={};i.r(nE),i.d(nE,{SharingAPIMessages:()=>dz,history:()=>nA,isSupported:()=>dG,shareWebContent:()=>dq});var nI={};i.r(nI),i.d(nI,{close:()=>dJ,isSupported:()=>dK});var nT={};i.r(nT),i.d(nT,{StageViewOpenMode:()=>tf,isSupported:()=>dZ,open:()=>dQ,self:()=>nI});var nP={};i.r(nP),i.d(nP,{captureImages:()=>dY,isSupported:()=>d1,retrieveImages:()=>d0});var nO={};i.r(nO),i.d(nO,{CameraRestriction:()=>tp,Source:()=>tg,hasPermission:()=>d5,image:()=>nP,requestPermission:()=>d8});var nR={};i.r(nR),i.d(nR,{isSupported:()=>fe,isWebStorageClearedOnUserLogOut:()=>d7});var nF={};i.r(nF),i.d(nF,{CallModalities:()=>tm,isSupported:()=>fn,startCall:()=>ft});var nk={};i.r(nk),i.d(nk,{ExpectedFailureReason:()=>ek,FailedReason:()=>eF,Messages:()=>iR,notifyAppLoaded:()=>fr,notifyExpectedFailure:()=>fa,notifyFailure:()=>fo,notifySuccess:()=>fi});var nM={};i.r(nM),i.d(nM,{getDragAndDropFiles:()=>fp,isSupported:()=>fm});var nN={};i.r(nN),i.d(nN,{getSettings:()=>fB,registerOnRemoveHandler:()=>fz,registerOnSaveHandler:()=>fW,setSettings:()=>fj,setValidityState:()=>fV});var nx={};i.r(nx),i.d(nx,{getDefaultSizeIfNotProvided:()=>fK,startTask:()=>f$,submitTask:()=>fJ,updateTask:()=>fG});var nD={};i.r(nD),i.d(nD,{ContainerState:()=>tv,LiveShareHost:()=>fZ,UserMeetingRole:()=>th,isSupported:()=>fQ});var nU,nL,n_,nH,nV,nB,nj,nW,nz,nq,n$={};function nG(e){return void 0!==(null==e?void 0:e.errorCode)}i.r(n$),i.d(n$,{CartStatus:()=>ty,Intent:()=>tw,addOrUpdateCartItems:()=>f8,cartVersion:()=>f6,getCart:()=>f5,isSupported:()=>f7,removeCartItems:()=>f4,updateCartStatus:()=>f9}),(f=nU||(nU={})).Inline="inline",f.Desktop="desktop",f.Web="web",(nL||(nL={})).M365Content="m365content",(p=n_||(n_={})).DriveId="driveId",p.GroupId="groupId",p.SiteId="siteId",p.UserId="userId",(g=nH||(nH={}))[g.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",g[g.INTERNAL_ERROR=500]="INTERNAL_ERROR",g[g.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",g[g.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",g[g.NETWORK_ERROR=2e3]="NETWORK_ERROR",g[g.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",g[g.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",g[g.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",g[g.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",g[g.THROTTLE=7e3]="THROTTLE",g[g.USER_ABORT=8e3]="USER_ABORT",g[g.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",g[g.OLD_PLATFORM=9e3]="OLD_PLATFORM",g[g.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",g[g.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED",(m=nV||(nV={})).GeoLocation="geolocation",m.Media="media",(h=nB||(nB={})).BCAIS="bcais",h.BCWAF="bcwaf",h.BCWBF="bcwbf",(v=nj||(nj={})).Faculty="faculty",v.Student="student",v.Other="other",(w=nW||(nW={})).Adult="adult",w.MinorNoParentalConsentRequired="minorNoParentalConsentRequired",w.MinorWithoutParentalConsent="minorWithoutParentalConsent",w.MinorWithParentalConsent="minorWithParentalConsent",w.NonAdult="nonAdult",(y=nz||(nz={})).HigherEducation="higherEducation",y.K12="k12",y.Other="other",(C=nq||(nq={})).TextPlain="text/plain",C.TextHtml="text/html",C.ImagePNG="image/png",C.ImageJPEG="image/jpeg";let nJ=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","teams.live.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","devspaces.skype.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","work.bing.com","www.bing.com","www.staging-bing-int.com","*.cloud.microsoft","*.m365.cloud.microsoft","chatuxmanager.svc.cloud.microsoft","copilot.microsoft.com","windows.msn.com","fa000000125.resources.office.net","fa000000129.resources.office.net","fa000000124.resources.office.net","fa000000128.resources.office.net","fa000000136.resources.office.net"]}'),nK="2.0.1",nQ="2.0.3",nZ="1.9.0",nX="1.8.0",nY=i.t(nJ,2).validOrigins,n0=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),n1=/^https:\/\//,n2="https",n3="teams.microsoft.com",n6="The library has not yet been initialized";var n5=i(933);function n8(e,t,n){if("number"==typeof e){var r;if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return function(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}(r=e),n9(r<0?0:0|n7(r))}return n4(e,t,n)}function n4(e,t,n){if("string"==typeof e){var r=e,i=t;if("string"==typeof i&&""!==i||(i="utf8"),!n8.isEncoding(i))throw TypeError("Unknown encoding: "+i);let n=0|function(e,t){if(n8.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||re(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return rt(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return rn(e).length;default:if(i)return r?-1:rt(e).length;t=(""+t).toLowerCase(),i=!0}}(r,i),o=n9(n),a=o.write(r,i);return a!==n&&(o=o.slice(0,a)),o}if(ArrayBuffer.isView(e)){var o=e;if(re(o,Uint8Array)){let e=new Uint8Array(o);return ri(e.buffer,e.byteOffset,e.byteLength)}return ro(o)}if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(re(e,ArrayBuffer)||e&&re(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(re(e,SharedArrayBuffer)||e&&re(e.buffer,SharedArrayBuffer)))return ri(e,t,n);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let a=e.valueOf&&e.valueOf();if(null!=a&&a!==e)return n8.from(a,t,n);let s=function(e){var t;if(n8.isBuffer(e)){let t=0|n7(e.length),n=n9(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?n9(0):ro(e):"Buffer"===e.type&&Array.isArray(e.data)?ro(e.data):void 0}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return n8.from(e[Symbol.toPrimitive]("string"),t,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function n9(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,n8.prototype),t}function n7(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function re(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function rt(e,t){let n;t=t||1/0;let r=e.length,i=null,o=[];for(let a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319||a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function rn(e){return n5.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(rr,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}n8.TYPED_ARRAY_SUPPORT=function(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),n8.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required"),n8.from=function(e,t,n){return n4(e,t,n)},Object.setPrototypeOf(n8.prototype,Uint8Array.prototype),Object.setPrototypeOf(n8,Uint8Array),n8.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n8.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==n8.prototype};let rr=/[^+/0-9A-Za-z-_]/g;function ri(e,t,n){let r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),n8.prototype),r}function ro(e){let t=e.length<0?0:0|n7(e.length),n=n9(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function ra(e,t,n){n=Math.min(e.length,n);let r=[],i=t;for(;i<n;){let t=e[i],o=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=n){let n,r,s,l;switch(a){case 1:t<128&&(o=t);break;case 2:128==(192&(n=e[i+1]))&&(l=(31&t)<<6|63&n)>127&&(o=l);break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(l=(15&t)<<12|(63&n)<<6|63&r)>2047&&(l<55296||l>57343)&&(o=l);break;case 4:n=e[i+1],r=e[i+2],s=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(l=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&s)>65535&&l<1114112&&(o=l)}}null===o?(o=65533,a=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=a}var o=r;let a=o.length;if(a<=4096)return String.fromCharCode.apply(String,o);let s="",l=0;for(;l<a;)s+=String.fromCharCode.apply(String,o.slice(l,l+=4096));return s}function rs(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0)||(n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,n){let r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=ru[e[r]];return i}(this,t,n);case"utf8":case"utf-8":return ra(this,t,n);case"ascii":return function(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}(this,t,n);case"latin1":case"binary":return function(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}(this,t,n);case"base64":var i,o,a;return i=this,o=t,a=n,0===o&&a===i.length?n5.fromByteArray(i):n5.fromByteArray(i.slice(o,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){let r=e.slice(t,n),i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}(this,t,n);default:if(r)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function rl(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}n8.prototype.toString=function(){let e=this.length;return 0===e?"":0==arguments.length?ra(this,0,e):rs.apply(this,arguments)},n8.prototype.write=function(e,t,n,r){var i,o,a,s,l,u,c,d;if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}let f=this.length-t;if((void 0===n||n>f)&&(n=f),e.length>0&&(n<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let p=!1;for(;;)switch(r){case"hex":return function(e,t,n,r){let i;n=Number(n)||0;let o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;let a=t.length;for(r>a/2&&(r=a/2),i=0;i<r;++i){var s;let r=parseInt(t.substr(2*i,2),16);if((s=r)!=s)break;e[n+i]=r}return i}(this,e,t,n);case"utf8":case"utf-8":return i=t,o=n,rl(rt(e,this.length-i),this,i,o);case"ascii":case"latin1":case"binary":return a=t,s=n,rl(function(e){let t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(e),this,a,s);case"base64":return l=t,u=n,rl(rn(e),this,l,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c=t,d=n,rl(function(e,t){let n,r,i=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i.push(n%256),i.push(r);return i}(e,this.length-c),this,c,d);default:if(p)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),p=!0}};let ru=function(){let e="0123456789abcdef",t=Array(256);for(let n=0;n<16;++n){let r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}(),rc={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},rd=new Uint8Array(16),rf=[];for(let e=0;e<256;++e)rf.push((e+256).toString(16).slice(1));let rp=function(t,n,r){if(rc.randomUUID&&!n&&!t)return rc.randomUUID();let i=(t=t||{}).random||(t.rng||function(){if(!e&&!(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(rd)})();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,n){r=r||0;for(let e=0;e<16;++e)n[r+e]=i[e];return n}return function(e,t=0){return rf[e[t+0]]+rf[e[t+1]]+rf[e[t+2]]+rf[e[t+3]]+"-"+rf[e[t+4]]+rf[e[t+5]]+"-"+rf[e[t+6]]+rf[e[t+7]]+"-"+rf[e[t+8]]+rf[e[t+9]]+"-"+rf[e[t+10]]+rf[e[t+11]]+rf[e[t+12]]+rf[e[t+13]]+rf[e[t+14]]+rf[e[t+15]]}(i)},rg=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,rm=function(e){return"string"==typeof e&&rg.test(e)};(b=eA||(eA={})).desktop="desktop",b.web="web",b.android="android",b.ios="ios",b.ipados="ipados",b.macos="macos",b.visionOS="visionOS",b.rigel="rigel",b.surfaceHub="surfaceHub",b.teamsRoomsWindows="teamsRoomsWindows",b.teamsRoomsAndroid="teamsRoomsAndroid",b.teamsPhones="teamsPhones",b.teamsDisplays="teamsDisplays",(S=eE||(eE={})).office="Office",S.outlook="Outlook",S.outlookWin32="OutlookWin32",S.orange="Orange",S.places="Places",S.teams="Teams",S.teamsModern="TeamsModern",(A=eI||(eI={})).settings="settings",A.content="content",A.authentication="authentication",A.remove="remove",A.task="task",A.sidePanel="sidePanel",A.stage="stage",A.meetingStage="meetingStage",(E=eT||(eT={}))[E.Standard=0]="Standard",E[E.Edu=1]="Edu",E[E.Class=2]="Class",E[E.Plc=3]="Plc",E[E.Staff=4]="Staff",(I=eP||(eP={}))[I.Admin=0]="Admin",I[I.User=1]="User",I[I.Guest=2]="Guest",(T=eO||(eO={})).Large="large",T.Medium="medium",T.Small="small",(P=eR||(eR={})).Regular="Regular",P.Private="Private",P.Shared="Shared";let rh={errorCode:nH.NOT_SUPPORTED_ON_PLATFORM},rv={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},rw=Error("Invalid input count: Must supply a valid image count (limit of 10)."),ry=Error("Invalid response: Received more images than the specified max limit in the response.");function rC(e){return(t,n)=>{if(!t)throw Error(e||n)}}function rb(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;let n=e.split("."),r=t.split(".");function i(e){return/^\d+$/.test(e)}if(!n.every(i)||!r.every(i))return NaN;for(;n.length<r.length;)n.push("0");for(;r.length<n.length;)r.push("0");for(let e=0;e<n.length;++e)if(Number(n[e])!=Number(r[e]))return Number(n[e])>Number(r[e])?1:-1;return 0}function rS(e,t,...n){let r=e(...n);return r.then(()=>{t&&t(null)}).catch(e=>{t&&t(e)}),r}function rA(e){return!(rb(`${e.majorVersion}.${e.minorVersion}`,"1.5")>=0)}function rE(e){return"https:"===e.protocol}function rI(){if(rT())throw Error("window object undefined at SSR check");return window}function rT(){return"undefined"==typeof window}function rP(e,t){var n;if(rR(e)||!((n=e).length<256&&n.length>4)||!function(e){for(let t=0;t<e.length;t++){let n=e.charCodeAt(t);if(n<32||n>126)return!1}return!0}(e))throw t||Error("id is not valid.")}function rO(e,t){let n=e.toString().toLocaleLowerCase();if(rR(n))throw t||Error("Invalid Url");if(n.length>2048)throw t||Error("Url exceeds the maximum size of 2048 characters");if(!rE(e))throw t||Error("Url should be a valid https url")}function rR(e){return RegExp(`${/<script[^>]*>|&lt;script[^&]*&gt;|%3Cscript[^%]*%3E/gi.source}|${/<\/script[^>]*>|&lt;\/script[^&]*&gt;|%3C\/script[^%]*%3E/gi.source}`,"gi").test(e)}let rF=!!performance&&"now"in performance;function rk(){return rF?performance.now()+performance.timeOrigin:void 0}class rM{constructor(e=rp()){this.uuid=e,function(e){if(!e)throw Error("id must not be empty");if(!1===rm(e))throw Error("id must be a valid UUID")}(e)}toString(){return this.uuid}serialize(){return this.toString()}}class rN{}rN.initializeCalled=!1,rN.initializeCompleted=!1,rN.additionalValidOrigins=[],rN.initializePromise=void 0,rN.isFramelessWindow=!1,rN.frameContext=void 0,rN.hostClientType=void 0,rN.printCapabilityEnabled=!1,rN.teamsJsInstanceId=(new rM).toString();var rx=i(815);let rD=new rM,rU=rx.debug.formatArgs;rx.debug.formatArgs=function(e){e[0]=`(${(new Date).toISOString()}): ${e[0]} [${rD.toString()}]`,rU.call(this,e)};let rL=(0,rx.debug)("teamsJs");function r_(e){return rL.extend(e)}function rH(e,t){return`${e}_${t}`}function rV(e){return/^v\d+_[\w.]+$/.test(e)}var rB=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};let rj=r_("runtime");function rW(e){return 4===e.apiVersion}let rz={apiVersion:-1,supports:{}},rq={apiVersion:4,isNAAChannelRecommended:!1,isDeeplyNestedAuthSupported:!1,hostVersionsInfo:rv,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{},parentCommunication:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},r$=[eA.desktop,eA.web,eA.rigel,eA.surfaceHub,eA.teamsRoomsWindows,eA.teamsRoomsAndroid,eA.teamsPhones,eA.teamsDisplays],rG=[...r$,eA.android,eA.ios,eA.ipados,eA.visionOS],rJ=[{versionToUpgradeFrom:1,upgradeToNextVersion:e=>{var t;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:null==(t=e.supports.dialog)?void 0:t.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:e=>{let t=e.supports,{appNotification:n}=t,r=rB(t,["appNotification"]);return Object.assign(Object.assign({},e),{apiVersion:3,supports:r})}},{versionToUpgradeFrom:3,upgradeToNextVersion:e=>{var t,n,r,i,o;return{apiVersion:4,hostVersionsInfo:e.hostVersionsInfo,isNAAChannelRecommended:e.isNAAChannelRecommended,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:null==(t=e.supports.dialog)?void 0:t.card,url:{bot:null==(r=null==(n=e.supports.dialog)?void 0:n.url)?void 0:r.bot,parentCommunication:(null==(i=e.supports.dialog)?void 0:i.url)?{}:void 0},update:null==(o=e.supports.dialog)?void 0:o.update}:void 0})}}}],rK={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:r$}],"1.9.0":[{capability:{location:{}},hostClientTypes:rG}],"2.0.0":[{capability:{people:{}},hostClientTypes:rG},{capability:{sharing:{}},hostClientTypes:[eA.desktop,eA.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[eA.android,eA.desktop,eA.ios,eA.teamsRoomsAndroid,eA.teamsPhones,eA.teamsDisplays,eA.web]},{capability:{webStorage:{}},hostClientTypes:[eA.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[eA.android,eA.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[eA.android,eA.ios]}],"2.1.1":[{capability:{nestedAppAuth:{}},hostClientTypes:[eA.android,eA.ios,eA.ipados,eA.visionOS]}]},rQ=rj.extend("generateBackCompatRuntimeConfig"),rZ=rj.extend("applyRuntimeConfig");function rX(e){"string"==typeof e.apiVersion&&(rZ("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=Object.assign(Object.assign({},e),{apiVersion:1})),rZ("Fast-forwarding runtime %o",e);let t=function(e){let t=e;if(t.apiVersion<4&&rJ.forEach(e=>{t.apiVersion===e.versionToUpgradeFrom&&(t=e.upgradeToNextVersion(t))}),rW(t))return t;throw Error("Received a runtime that could not be upgraded to the latest version")}(e);rZ("Applying runtime %o",t),rz=function e(t){return Object.keys(t).forEach(n=>{null!==t[n]&&void 0!==t[n]&&"object"==typeof t[n]&&e(t[n])}),Object.freeze(t)}(t)}let rY="2.36.0-beta.1",r0={childProxyingCommunication:!1};function r1(){r0.childProxyingCommunication=!0}function r2(){return r0.childProxyingCommunication}let r3={disableEnforceOriginMatchForChildResponses:!1};function r6(){return r3}function r5(e){r3=e}function r8(e){return r3=Object.assign(Object.assign({},r3),e)}var r4=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};let r9=e=>{let{uuid:t}=e,n=r4(e,["uuid"]),r=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:r})},r7=e=>{let{uuidAsString:t}=e;return Object.assign(Object.assign({},r4(e,["uuidAsString"])),{uuid:t?new rM(t):void 0})},ie=e=>{let{uuidAsString:t}=e;return Object.assign(Object.assign({},r4(e,["uuidAsString"])),{uuid:t?new rM(t):void 0})},it=e=>{let{uuid:t}=e,n=r4(e,["uuid"]),r=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:r})};function ir(e){return void 0!==e.uuidAsString?`${e.uuidAsString} (legacy id: ${e.id})`:void 0!==e.uuid?`${e.uuid.toString()} (legacy id: ${e.id})`:`legacy id: ${e.id} (no uuid)`}let ii=r_("flushMessageQueue");function io(e,t,n,r){if(e&&t&&0!==n.length)for(;n.length>0;){let i=n.shift();if(i){let n=r9(i);ii("Flushing message %s from %s message queue via postMessage.",ir(n),r),e.postMessage(n,t)}}}let ia=r_("internal"),is=ia.extend("ensureInitializeCalled"),il=ia.extend("ensureInitialized");function iu(){if(!rN.initializeCalled)throw is(n6),Error(n6)}function ic(e,...t){if(!rN.initializeCompleted)throw il("%s. initializeCalled: %s",n6,rN.initializeCalled.toString()),Error(n6);if(t&&t.length>0){let e=!1;for(let n=0;n<t.length;n++)if(t[n]===rN.frameContext){e=!0;break}if(!e)throw Error(`This call is only allowed in following contexts: ${JSON.stringify(t)}. Current context: "${rN.frameContext}".`)}if(rW(e))return!0;throw -1===e.apiVersion?Error("The runtime has not yet been initialized"):Error("The runtime version is not supported")}function id(e=nK){let t=rb(rN.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function ip(e=nK){if(rN.hostClientType!=eA.android&&rN.hostClientType!=eA.ios&&rN.hostClientType!=eA.ipados&&rN.hostClientType!=eA.visionOS)throw{errorCode:nH.NOT_SUPPORTED_ON_PLATFORM};if(!id(e))throw{errorCode:nH.OLD_PLATFORM}}function ig(e){if(!(e instanceof ih))throw Error(`Potential app id (${e}) is invalid; it is not an instance of AppId class.`)}class im{constructor(e){this.idAsString=e,function(e){if(rR(e))throw Error(`Potential app id (${e}) is invalid; it contains script tags.`);if([...e].some(e=>{let t=e.charCodeAt(0);return t<32||t>126}))throw Error(`Potential app id (${e}) is invalid; it contains non-printable characters.`)}(e)}serialize(){return this.toString()}toString(){return this.idAsString}}class ih extends im{constructor(e){super(e),function(e){var t;if(!((t=e).length<256&&t.length>4))throw Error(`Potential app id (${e}) is invalid; its length ${e.length} is not within the length limits (4-256).`)}(e)}toJSON(){return{appIdAsString:this.toString()}}}function iv(e){return null==e}let iw=r_("messageChannels.telemetry");function iy(){var e,n,r,i;return e=this,n=void 0,r=void 0,i=function*(){if(t)return iw("Returning telemetry port from cache"),t;if(!iC())throw rh;return t=yield a5(rH("v1","messageChannels.telemetry.getTelemetryPort"),"messageChannels.telemetry.getTelemetryPort")},new(r||(r=Promise))(function(t,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var n;e.done?t(e.value):((n=e.value)instanceof r?n:new r(function(e){e(n)})).then(a,s)}l((i=i.apply(e,n||[])).next())})}function iC(){var e;return!(!ic(rz)||!(null==(e=rz.supports.messageChannels)?void 0:e.telemetry))}function ib(){t=void 0}let iS=r_("messageChannels.dataLayer");function iA(){var e,t,r,i;return e=this,t=void 0,r=void 0,i=function*(){if(n)return iS("Returning dataLayer port from cache"),n;if(!iE())throw rh;return n=yield a5(rH("v1","messageChannels.dataLayer.getDataLayerPort"),"messageChannels.dataLayer.getDataLayerPort")},new(r||(r=Promise))(function(n,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}l((i=i.apply(e,t||[])).next())})}function iE(){var e;return!(!ic(rz)||!(null==(e=rz.supports.messageChannels)?void 0:e.dataLayer))}function iI(){n=void 0}function iT(e){var t;if(!e)throw Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");ic(rz),aT.beforeSuspendOrTerminateHandler=t=e,iv(t)||a8(rH("v2","registerBeforeSuspendOrTerminateHandler"),"registerHandler",["beforeUnload"])}function iP(e){var t;if(!e)throw Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");ic(rz),aT.resumeHandler=t=e,iv(t)||a8(rH("v2","registerOnResumeHandler"),"registerHandler",["load"])}let iO=r_("app"),iR={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"};function iF(){return rN.initializeCompleted}function ik(){return rN.frameContext}function iM(e){return oM(rH("v2","app.initialize"),e)}function iN(e){aK.currentWindow=e}function ix(){rN.initializeCalled&&(aT.uninitializeHandlers(),rN.initializeCalled=!1,rN.initializeCompleted=!1,rN.initializePromise=void 0,rN.additionalValidOrigins=[],rN.frameContext=void 0,rN.hostClientType=void 0,rN.isFramelessWindow=!1,ib(),iI(),aK.currentWindow&&aK.currentWindow.removeEventListener("message",aQ.messageListener,!1),aK.currentWindow=null,aK.parentWindow=null,aK.parentOrigin=null,aQ.parentMessageQueue=[],aQ.nextMessageId=0,aQ.callbacks.clear(),aQ.promiseCallbacks.clear(),aQ.portCallbacks.clear(),aQ.legacyMessageIdsToUuidMap={},aW.clearMessages(),a_.window=null,a_.origin=null,a_.messageQueue=[])}function iD(){return new Promise(e=>{iu(),e(aZ(rH("v2","app.getContext"),"getContext"))}).then(e=>{var t,n;return{actionInfo:(t=e).actionInfo,app:{locale:t.locale,sessionId:t.appSessionId?t.appSessionId:"",theme:t.theme?t.theme:"default",iconPositionVertical:t.appIconPosition,osLocaleInfo:t.osLocaleInfo,parentMessageId:t.parentMessageId,userClickTime:t.userClickTime,userClickTimeV2:t.userClickTimeV2,userFileOpenPreference:t.userFileOpenPreference,host:{name:t.hostName?t.hostName:eE.teams,clientType:t.hostClientType?t.hostClientType:eA.web,sessionId:t.sessionId?t.sessionId:"",ringId:t.ringId},appLaunchId:t.appLaunchId,appId:t.appId?new ih(t.appId):void 0,manifestVersion:t.manifestVersion},page:{id:t.entityId,frameContext:t.frameContext?t.frameContext:rN.frameContext,subPageId:t.subEntityId,isFullScreen:t.isFullScreen,isMultiWindow:t.isMultiWindow,isBackgroundLoad:t.isBackgroundLoad,sourceOrigin:t.sourceOrigin},user:{id:null!=(n=t.userObjectId)?n:"",displayName:t.userDisplayName,isCallingAllowed:t.isCallingAllowed,isPSTNCallingAllowed:t.isPSTNCallingAllowed,licenseType:t.userLicenseType,loginHint:t.loginHint,userPrincipalName:t.userPrincipalName,tenant:t.tid?{id:t.tid,teamsSku:t.tenantSKU}:void 0},channel:t.channelId?{id:t.channelId,displayName:t.channelName,relativeUrl:t.channelRelativeUrl,membershipType:t.channelType,defaultOneNoteSectionId:t.defaultOneNoteSectionId,ownerGroupId:t.hostTeamGroupId,ownerTenantId:t.hostTeamTenantId}:void 0,chat:t.chatId?{id:t.chatId}:void 0,meeting:t.meetingId?{id:t.meetingId}:void 0,sharepoint:t.sharepoint,team:t.teamId?{internalId:t.teamId,displayName:t.teamName,type:t.teamType,groupId:t.groupId,templateId:t.teamTemplateId,isArchived:t.isTeamArchived,userRole:t.userTeamRole}:void 0,sharePointSite:t.teamSiteUrl||t.teamSiteDomain||t.teamSitePath||t.mySitePath||t.mySiteDomain?{teamSiteUrl:t.teamSiteUrl,teamSiteDomain:t.teamSiteDomain,teamSitePath:t.teamSitePath,teamSiteId:t.teamSiteId,mySitePath:t.mySitePath,mySiteDomain:t.mySiteDomain}:void 0,dialogParameters:t.dialogParameters||{}}})}function iU(){iu(),oN(rH("v2","app.notifyAppLoaded"))}function iL(){return function(e){return oF(this,void 0,void 0,function*(){if(rN.initializeCompleted)return oU(e);if(!rN.initializePromise)throw Error(n6);return rN.initializePromise.then(()=>oU(e))})}(rH("v2","app.notifySuccess"))}function i_(e){iu(),oD(rH("v2","app.notifyFailure"),e)}function iH(e){iu(),ox(rH("v2","app.notifyExpectedFailure"),e)}function iV(e){o_(rH("v2","app.registerOnThemeChangeHandler"),e)}function iB(e){aT.hostToAppPerformanceMetricsHandler=e}function ij(e){return oH(rH("v2","app.openLink"),e)}function iW(e){i3(rH(i2,"dialog.update.resize"),e)}function iz(){return!(!ic(rz)||!rz.supports.dialog)&&!!rz.supports.dialog.update}function iq(e,t,n){i5(rH(i2,"dialog.url.bot.open"),e,t,n)}function i$(){return ic(rz)&&void 0!==(rz.supports.dialog&&rz.supports.dialog.url&&rz.supports.dialog.url.bot)}function iG(e){if(ic(rz,eI.task),!iQ())throw rh;a8(rH(i2,"dialog.url.parentCommunication.sendMessageToParentFromDialog"),"messageForParent",[e])}function iJ(e){if(ic(rz,eI.content,eI.sidePanel,eI.meetingStage),!iQ())throw rh;a8(rH(i2,"dialog.url.parentCommunication.sendMessageToDialog"),"messageForChild",[e])}function iK(e){if(ic(rz,eI.task),!iQ())throw rh;for(aF("messageForChild"),aR(rH(i2,"dialog.url.parentCommunication.registerMessageForChildHandler"),"messageForChild",e),i9.reverse();i9.length>0;)e(i9.pop())}function iQ(){var e,t;return ic(rz)&&!!(null==(t=null==(e=rz.supports.dialog)?void 0:e.url)?void 0:t.parentCommunication)}function iZ(e,t,n){i6(rH(i2,"dialog.url.open"),e,t,n)}function iX(e,t){i8(rH(i2,"dialog.url.submit"),e,t)}function iY(){return ic(rz)&&void 0!==(rz.supports.dialog&&rz.supports.dialog.url)}function i0(e){return{url:e.url,height:e.size?e.size.height:eO.Small,width:e.size?e.size.width:eO.Small,title:e.title,fallbackUrl:e.fallbackUrl}}function i1(e){let t=i0(e);return t.completionBotId=e.completionBotId,t}(O=eF||(eF={})).AuthFailed="AuthFailed",O.Timeout="Timeout",O.Other="Other",(R=ek||(ek={})).PermissionError="PermissionError",R.NotFound="NotFound",R.Throttling="Throttling",R.Offline="Offline",R.Other="Other",iO("teamsjs instance is version %s, starting at %s UTC (%s local)",rY,(new Date).toISOString(),(new Date).toLocaleString()),function(){if(rT())return;let e=document.getElementsByTagName("script"),t=e&&e[e.length-1]&&e[e.length-1].src,n="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";t&&0!==t.length?iO("teamsjs is being used from %s. %s",t,n):iO("teamsjs is being used from a script tag embedded directly in your html. %s",n)}();let i2="v2";function i3(e,t){if(ic(rz,eI.content,eI.sidePanel,eI.task,eI.meetingStage),!iz())throw rh;a8(e,"tasks.updateTask",[t])}function i6(e,t,n,r){if(ic(rz,eI.content,eI.sidePanel,eI.meetingStage),!iY())throw rh;r&&aR(rH(i2,"dialog.url.registerMessageForParentHandler"),"messageForParent",r),a8(e,"tasks.startTask",[i0(t)],(e,t)=>{null==n||n({err:e,result:t}),aF("messageForParent")})}function i5(e,t,n,r){if(ic(rz,eI.content,eI.sidePanel,eI.meetingStage),!i$())throw rh;r&&aR(rH(i2,"dialog.url.bot.registerMessageForParentHandler"),"messageForParent",r),a8(e,"tasks.startTask",[i1(t)],(e,t)=>{null==n||n({err:e,result:t}),aF("messageForParent")})}function i8(e,t,n){if(ic(rz,eI.task,eI.content),!iY())throw rh;a8(e,"tasks.completeTask",[t,n?Array.isArray(n)?n:[n]:[]])}function i4(e){return{card:e.card,height:e.size?e.size.height:eO.Small,width:e.size?e.size.width:eO.Small,title:e.title}}let i9=[];function i7(e){rN.frameContext&&(rN.frameContext===eI.task?i9.push(e):aF("messageForChild"))}function oe(e,t){if(ic(rz,eI.content,eI.sidePanel,eI.meetingStage),!ot())throw rh;let n=function(e){let t=i4(e);return t.completionBotId=e.completionBotId,t}(e);a8(rH(i2,"dialog.adaptiveCard.bot.open"),"tasks.startTask",[n],(e,n)=>{null==t||t({err:e,result:n})})}function ot(){let e=rz.hostVersionsInfo&&rz.hostVersionsInfo.adaptiveCardSchemaVersion&&!rA(rz.hostVersionsInfo.adaptiveCardSchemaVersion);return ic(rz)&&void 0!==(e&&rz.supports.dialog&&rz.supports.dialog.card&&rz.supports.dialog.card.bot)}function on(e,t){if(ic(rz,eI.content,eI.sidePanel,eI.meetingStage),!or())throw rh;let n=i4(e);a8(rH(i2,"dialog.adaptiveCard.open"),"tasks.startTask",[n],(e,n)=>{null==t||t({err:e,result:n})})}function or(){let e=rz.hostVersionsInfo&&rz.hostVersionsInfo.adaptiveCardSchemaVersion&&!rA(rz.hostVersionsInfo.adaptiveCardSchemaVersion);return ic(rz)&&void 0!==(e&&rz.supports.dialog&&rz.supports.dialog.card)}function oi(){aR(rH(i2,"dialog.registerMessageForChildHandler"),"messageForChild",i7,!1)}function oo(){return!(!ic(rz)||!rz.supports.dialog)}(F=eM||(eM={}))[F.ifRoom=0]="ifRoom",F[F.overflowOnly=1]="overflowOnly";class oa{constructor(){this.enabled=!0,this.selected=!1}}function os(){aR(rH("v2","menus.registerNavBarMenuItemPressHandler"),"navBarMenuItemPress",od,!1),aR(rH("v2","menus.registerActionMenuItemPressHandler"),"actionMenuItemPress",op,!1),aR(rH("v2","menus.registerSetModuleViewHandler"),"setModuleView",ou,!1)}function ol(e,t){if(ic(rz),!og())throw rh;s=t,a8(rH("v2","menus.setUpViews"),"setUpViews",[e])}function ou(e){s&&s(e)||(ic(rz),a8(rH("v2","menus.handleViewConfigItemPress"),"viewConfigItemPress",[e]))}function oc(e,t){if(ic(rz),!og())throw rh;r=t,a8(rH("v2","menus.setNavBarMenu"),"setNavBarMenu",[e])}function od(e){r&&r(e)||(ic(rz),a8(rH("v2","menus.handleNavBarMenuItemPress"),"handleNavBarMenuItemPress",[e]))}function of(e,t){if(ic(rz),!og())throw rh;a=t,a8(rH("v2","menus.showActionMenu"),"showActionMenu",[e])}function op(e){a&&a(e)||(ic(rz),a8(rH("v2","menus.handleActionMenuItemPress"),"handleActionMenuItemPress",[e]))}function og(){return!(!ic(rz)||!rz.supports.menus)}function om(){aR(rH(ad,"pages.config.registerSettingsSaveHandler"),"settings.save",oS,!1),aR(rH(ad,"pages.config.registerSettingsRemoveHandler"),"settings.remove",oI,!1)}function oh(e){return ay(rH(ad,"pages.config.setValidityState"),e)}function ov(e){return ab(rH(ad,"pages.config.setConfig"),e)}function ow(e){oy(rH(ad,"pages.config.registerOnSaveHandler"),e,()=>{if(!iv(e)&&!oP())throw rh})}function oy(e,t,n){iv(t)||ic(rz,eI.settings),n&&n(),l=t,iv(t)||a8(e,"registerHandler",["save"])}function oC(e){ob(rH(ad,"pages.config.registerOnRemoveHandler"),e,()=>{if(!iv(e)&&!oP())throw rh})}function ob(e,t,n){iv(t)||ic(rz,eI.remove,eI.settings),n&&n(),u=t,iv(t)||a8(e,"registerHandler",["remove"])}function oS(e){let t=new oE(e);l?l(t):aH()?aj("settings.save",[e]):t.notifySuccess()}function oA(e){aM(rH(ad,"pages.config.registerChangeConfigHandler"),"changeSettings",e,[eI.content],()=>{if(!oP())throw rh})}(k=eN||(eN={})).dropDown="dropDown",k.popOver="popOver";class oE{constructor(e){this.notified=!1,this.result=e||{}}notifySuccess(){this.ensureNotNotified(),a8(rH(ad,"pages.saveEvent.notifySuccess"),"settings.save.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),a8(rH(ad,"pages.saveEvent.notifyFailure"),"settings.save.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw Error("The SaveEvent may only notify success or failure once.")}}function oI(){let e=new oT;u?u(e):aH()?aj("settings.remove",[]):e.notifySuccess()}class oT{constructor(){this.notified=!1}notifySuccess(){this.ensureNotNotified(),a8(rH(ad,"pages.removeEvent.notifySuccess"),"settings.remove.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),a8(rH(ad,"pages.removeEvent.notifyFailure"),"settings.remove.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw Error("The removeEventType may only notify success or failure once.")}}function oP(){return!(!ic(rz)||!rz.supports.pages)&&!!rz.supports.pages.config}class oO{}class oR extends oO{validate(e){return!0}deserialize(e){return e}}var oF=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};let ok=r_("app");function oM(e,t){var n,r;return rT()?(ok.extend("initialize")("window object undefined at initialization"),Promise.resolve()):(n=()=>{var n,r;return n=e,r=t,new Promise(e=>{rN.initializeCalled||(rN.initializeCalled=!0,aT.initializeHandlers(),rN.initializePromise=(function(e,t){if(aQ.messageListener=e=>(function(e){return aG(this,void 0,void 0,function*(){if(!e||!e.data||"object"!=typeof e.data)return void sr("Unrecognized message format received by app, message being ignored. Message: %o",e);let t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;return ss(t,n).then(r=>{var i,o;r?(i=t,o=n,rN.isFramelessWindow||aK.parentWindow&&!aK.parentWindow.closed&&i!==aK.parentWindow||(aK.parentWindow=i,aK.parentOrigin=o),aK.parentWindow&&aK.parentWindow.closed&&(aK.parentWindow=null,aK.parentOrigin=null),io(aK.parentWindow,aK.parentOrigin,aQ.parentMessageQueue,"parent"),t!==aK.parentWindow?r2()&&(a_.window&&!a_.window.closed&&t!==a_.window||(a_.window=t,a_.origin=n),a_.window&&a_.window.closed?(a_.window=null,a_.origin=null,!1):a_.window===t)&&function(e,t,n,r){var i,o,a,s;i=this,o=void 0,a=void 0,s=function*(){a_.window===t&&(io(a_.window,a_.origin,a_.messageQueue,"child"),function(e,t,n){if(void 0===e.data.id||void 0===e.data.func)return;let r=r7(e.data),[i,o]=aO(r.func,r.args);if(i&&void 0!==o)return aV("Handler called in response to message %s from child. Returning response from handler to child, action: %s.",ir(r),r.func),aB(r.id,r.uuid,Array.isArray(o)?o:[o]);aV("No handler for message %s from child found; relaying message on to parent, action: %s. Relayed message will have a new id.",ir(r),r.func),function(e,t,n){let r=t(rH("v2","tasks.startTask"),e.func,e.args,!0,e.teamsJsInstanceId),i=a_.origin;n(r.uuid,(...t)=>{if(!a_.window)return;if(!r3.disableEnforceOriginMatchForChildResponses&&i!==a_.origin)return void aV("Origin of child window has changed, not sending response back to child window");let n=t.pop();aV("Message from parent being relayed to child, id: %s",ir(e)),aB(e.id,e.uuid,t,n)})}(r,t,n)}(e,n,r))},new(a||(a=Promise))(function(e,t){function n(e){try{l(s.next(e))}catch(e){t(e)}}function r(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof a?i:new a(function(e){e(i)})).then(n,r)}l((s=s.apply(i,o||[])).next())})}(e,t,sn,(e,t)=>aQ.callbacks.set(e,t)):sd(e)):sr("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin, message: %o, source: %o, origin: %o",e,t,n)})})})(e),aK.currentWindow=aK.currentWindow||rI(),aK.parentWindow=aK.currentWindow.parent!==aK.currentWindow.self?aK.currentWindow.parent:aK.currentWindow.opener,aK.topWindow=aK.currentWindow.top,(aK.parentWindow||e)&&aK.currentWindow.addEventListener("message",aQ.messageListener,!1),!aK.parentWindow){let e=aK.currentWindow;if(!e.nativeInterface)return Promise.reject(Error("Initialization Failed. No Parent window found."));rN.isFramelessWindow=!0,e.onNativeMessage=sd}try{return aK.parentOrigin="*",a1(t,"initialize",[rY,4,e]).then(([e,t,n,r])=>((function(e,t,n){var r;if(rN.isFramelessWindow)return aq("Cannot polyfill nestedAppAuthBridge as current window is frameless");if(!t)return aq("Cannot polyfill nestedAppAuthBridge as current window does not exist");if(t.parent!==t.top)return aq("Default NAA bridge injection not supported in nested iframe. Use standalone NAA bridge instead.");let i=(()=>{try{return JSON.parse(e)}catch(e){return null}})();if(!i||!(null==(r=i.supports)?void 0:r.nestedAppAuth))return aq("Cannot polyfill nestedAppAuthBridge as current hub does not support nested app auth");if(t.nestedAppAuthBridge)return aq("nestedAppAuthBridge already exists on current window, skipping polyfill");let o=function(e,t){if(!e)return a$("nestedAppAuthBridge cannot be created as current window does not exist"),null;let{onMessage:n,sendPostMessage:r}=t,i=e=>t=>n(t,e);return{addEventListener:(t,n)=>{"message"===t?e.addEventListener(t,i(n)):a$(`Event ${t} is not supported by nestedAppAuthBridge`)},postMessage:e=>{let t=(()=>{try{return JSON.parse(e)}catch(e){return null}})();if(!t||"object"!=typeof t||"NestedAppAuthRequest"!==t.messageType)return void a$("Unrecognized data format received by app, message being ignored. Message: %o",e);r(e,rH("v2","nestedAppAuth.execute"))},removeEventListener:(t,n)=>{e.removeEventListener(t,i(n))}}}(t,n);o&&(t.nestedAppAuthBridge=o)})(r,aK.currentWindow,{onMessage:so,sendPostMessage:a9}),{context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r}))}finally{aK.parentOrigin=null}})(r,n).then(({context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r=nK})=>{rN.frameContext=e,rN.hostClientType=t,rN.clientSupportedSDKVersion=r;try{oL("Parsing %s",n);let e=JSON.parse(n);if(oL("Checking if %o is a valid runtime object",null!=e?e:"null"),!e||!e.apiVersion)throw Error("Received runtime config is invalid");n&&rX(e)}catch(e){if(!(e instanceof SyntaxError))throw e;try{oL("Attempting to parse %s as an SDK version",n),isNaN(rb(n,nK))||(rN.clientSupportedSDKVersion=n);let e=JSON.parse(r);if(oL("givenRuntimeConfig parsed to %o",null!=e?e:"null"),!e)throw Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");rX(e)}catch(e){if(!(e instanceof SyntaxError))throw e;rX(function(e,t,n){rQ("generating back compat runtime config for %s",e);let r=Object.assign({},t.supports);rQ("Supported capabilities in config before updating based on highestSupportedVersion: %o",r),Object.keys(n).forEach(t=>{rb(e,t)>=0&&n[t].forEach(e=>{void 0!==rN.hostClientType&&e.hostClientTypes.includes(rN.hostClientType)&&(r=function e(t,n){let r=Object.assign({},t);for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&("object"!=typeof n[i]||Array.isArray(n[i])?i in t||(r[i]=n[i]):r[i]=e(t[i]||{},n[i]));return r}(r,e.capability))})});let i={apiVersion:4,hostVersionsInfo:rv,isLegacyTeams:!0,supports:r};return rQ("Runtime config after updating based on highestSupportedVersion: %o",i),i}(rN.clientSupportedSDKVersion,rq,rK))}}rN.initializeCompleted=!0}),os(),om(),oi()),Array.isArray(r)&&function(e){let t=rN.additionalValidOrigins.concat(e.filter(e=>"string"==typeof e&&n1.test(e))),n={};rN.additionalValidOrigins=t.filter(e=>!n[e]&&(n[e]=!0,!0))}(r),void 0!==rN.initializePromise?e(rN.initializePromise):oL("GlobalVars.initializePromise is unexpectedly undefined")})},r=Error("SDK initialization timed out."),new Promise((e,t)=>{let i=setTimeout(t,6e4,r);n().then(t=>{clearTimeout(i),e(t)}).catch(e=>{clearTimeout(i),t(e)})}))}function oN(e){a8(e,iR.AppLoaded,[rY])}function ox(e,t){a8(e,iR.ExpectedFailure,[t.reason,t.message])}function oD(e,t){a8(e,iR.Failure,[t.reason,t.message])}function oU(e){return oF(this,void 0,void 0,function*(){var t;return ic(rz)&&(null==(t=rz.supports.app)?void 0:t.notifySuccessResponse)?a3(iR.Success,[rY],new oR,e).then(()=>({hasFinishedSuccessfully:!0})):(a8(e,iR.Success,[rY]),{hasFinishedSuccessfully:"unknown"})})}let oL=ok.extend("initializeHelper");function o_(e,t){var n,r;iv(t)||iu(),n=e,aT.themeChangeHandler=r=t,iv(r)||a8(n,"registerHandler",["themeChange"])}function oH(e,t){return new Promise(n=>{ic(rz,eI.content,eI.sidePanel,eI.settings,eI.task,eI.stage,eI.meetingStage),n(aX(e,"executeDeepLink",t))})}var oV=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};let oB=[],oj=r_("validateOrigin");function oW(){return oV(this,void 0,void 0,function*(){yield oz()})}function oz(e=!1){return oV(this,void 0,void 0,function*(){if(0!==oB.length&&!e)return oB;if(rT())return oB=nY,nY;{oj("Initiating fetch call to acquire valid origins list from CDN");let e=new AbortController,t=setTimeout(()=>e.abort(),1500);return fetch(n0,{signal:e.signal}).then(e=>{if(clearTimeout(t),!e.ok)throw Error("Invalid Response from Fetch Call");return oj("Fetch call completed and retrieved valid origins list from CDN"),e.json().then(e=>{if(function(e){let t=JSON.parse(e);try{t=JSON.parse(e)}catch(e){return!1}if(!t.validOrigins)return!1;for(let e of t.validOrigins)try{new URL("https://"+e)}catch(t){return oj("isValidOriginsFromCDN call failed to validate origin: %s",e),!1}return!0}(JSON.stringify(e)))return oB=e.validOrigins;throw Error("Valid origins list retrieved from CDN is invalid")})}).catch(e=>("AbortError"===e.name?oj("validOrigins fetch call to CDN failed due to Timeout of 1500 ms. Defaulting to fallback list"):oj("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",e),oB=nY))}})}function oq(e,t){if("*."===e.substring(0,2)){let n=e.substring(1);if(t.length>n.length&&t.split(".").length===n.split(".").length&&t.substring(t.length-n.length)===n)return!0}else if(e===t)return!0;return!1}function o$(e){aM(rH(ad,"pages.appButton.onClick"),"appButtonClick",e,[eI.content],()=>{if(!oK())throw rh})}function oG(e){aM(rH(ad,"pages.appButton.onHoverEnter"),"appButtonHoverEnter",e,[eI.content],()=>{if(!oK())throw rh})}function oJ(e){aM(rH(ad,"pages.appButton.onHoverLeave"),"appButtonHoverLeave",e,[eI.content],()=>{if(!oK())throw rh})}function oK(){return!(!ic(rz)||!rz.supports.pages)&&!!rz.supports.pages.appButton}function oQ(){aA()}function oZ(){return ap(rH(ad,"pages.backStack.navigateBack"))}function oX(e){oY(rH(ad,"pages.backStack.registerBackButtonHandler"),e,()=>{if(!iv(e)&&!o0())throw rh})}function oY(e,t,n){iv(t)||ic(rz),n&&n(),c=t,iv(t)||a8(e,"registerHandler",["backButton"])}function o0(){return!(!ic(rz)||!rz.supports.pages)&&!!rz.supports.pages.backStack}function o1(e){return new Promise(t=>{if(ic(rz,eI.content,eI.sidePanel,eI.settings,eI.task,eI.stage,eI.meetingStage),!o3())throw rh;t(a0(rH(ad,"pages.currentApp.navigateTo"),"pages.currentApp.navigateTo",e))})}function o2(){return new Promise(e=>{if(ic(rz,eI.content,eI.sidePanel,eI.settings,eI.task,eI.stage,eI.meetingStage),!o3())throw rh;e(a0(rH(ad,"pages.currentApp.navigateToDefaultPage"),"pages.currentApp.navigateToDefaultPage"))})}function o3(){return!(!ic(rz)||!rz.supports.pages)&&!!rz.supports.pages.currentApp}function o6(){if(ic(rz,eI.content),!o8())throw rh;a8(rH(ad,"pages.fullTrust.enterFullscreen"),"enterFullscreen",[])}function o5(){if(ic(rz,eI.content),!o8())throw rh;a8(rH(ad,"pages.fullTrust.exitFullscreen"),"exitFullscreen",[])}function o8(){return!(!ic(rz)||!rz.supports.pages)&&!!rz.supports.pages.fullTrust}function o4(e){return ag(rH(ad,"pages.tabs.navigateToTab"),e)}function o9(e){return am(rH(ad,"pages.tabs.getTabInstances"),e)}function o7(e){return ah(rH(ad,"pages.tabs.getMruTabInstances"),e)}function ae(){return!(!ic(rz)||!rz.supports.pages)&&!!rz.supports.pages.tabs}function at(e){let t=rH(ad,"pages.returnFocus");if(ic(rz),!ac())throw rh;if(void 0===e&&a8(t,"returnFocus",[!1]),"boolean"==typeof e)a8(t,"returnFocus",[e]);else switch(e){case eD.PreviousLandmark:case eD.GoToActivityFeed:a8(t,"returnFocus",[!1,e]);break;case eD.NextLandmark:a8(t,"returnFocus",[!0,e])}}function an(e){aM(rH(ad,"pages.registerFocusEnterHandler"),"focusEnter",e,[],()=>{if(!ac())throw rh})}function ar(e){aw(rH(ad,"pages.setCurrentFrame"),e)}function ai(e,t,n){oW(),oM(rH(ad,"pages.initializeWithFrameContext"),n).then(()=>t&&t()),ar(e)}function ao(){return aC(rH(ad,"pages.getConfig."))}function aa(e){return af(rH(ad,"pages.navigateCrossDomain"),e)}function as(e){return new Promise(t=>{var n,r;if(ic(rz,eI.content,eI.sidePanel,eI.settings,eI.task,eI.stage,eI.meetingStage),!ac())throw rh;let i=rH(ad,"pages.navigateToApp");t(rz.isLegacyTeams?aX(i,"executeDeepLink",function(e){let t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId.toString())+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl.toString()),(e.chatId||e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({chatId:e.chatId,channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}(aS(e)?e:Object.assign(Object.assign({},n=e),{appId:new ih(n.appId),webUrl:n.webUrl?new URL(n.webUrl):void 0}))):aX(i,"pages.navigateToApp",aS(e)?Object.assign(Object.assign({},r=e),{appId:r.appId.toString(),webUrl:r.webUrl?r.webUrl.toString():void 0}):e))})}function al(e){return av(rH(ad,"pages.shareDeepLink"),e)}function au(e){aM(rH(ad,"pages.registerFullScreenHandler"),"fullScreenChange",e,[],()=>{if(!iv(e)&&!ac())throw rh})}function ac(){return!(!ic(rz)||!rz.supports.pages)}oW(),(M=ex||(ex={}))[M.PreviousLandmark=0]="PreviousLandmark",M[M.NextLandmark=1]="NextLandmark",M[M.Read=2]="Read",M[M.Compose=3]="Compose",(N=eD||(eD={}))[N.PreviousLandmark=0]="PreviousLandmark",N[N.NextLandmark=1]="NextLandmark",N[N.GoToActivityFeed=2]="GoToActivityFeed";let ad="v2";function af(e,t){return new Promise(n=>{if(ic(rz,eI.content,eI.sidePanel,eI.settings,eI.remove,eI.task,eI.stage,eI.meetingStage),!ac())throw rh;n(aY(e,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))})}function ap(e){return new Promise(t=>{if(ic(rz),!o0())throw rh;t(aY(e,"navigateBack","Back navigation is not supported in the current client or context."))})}function ag(e,t){return new Promise(n=>{if(ic(rz),!ae())throw rh;n(aY(e,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",t))})}function am(e,t){return new Promise(n=>{if(ic(rz),!ae())throw rh;n(aZ(e,"getTabInstances",t))})}function ah(e,t){return new Promise(n=>{if(ic(rz),!ae())throw rh;n(aZ(e,"getMruTabInstances",t))})}function av(e,t){if(ic(rz,eI.content,eI.sidePanel,eI.meetingStage),!ac())throw rh;a8(e,"shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])}function aw(e,t){if(ic(rz,eI.content),!ac())throw rh;a8(e,"setFrameContext",[t])}function ay(e,t){if(ic(rz,eI.settings,eI.remove),!oP())throw rh;a8(e,"settings.setValidityState",[t])}function aC(e){return new Promise(t=>{if(ic(rz,eI.content,eI.settings,eI.remove,eI.sidePanel),!ac())throw rh;t(aZ(e,"settings.getSettings"))})}function ab(e,t){return new Promise(n=>{if(ic(rz,eI.content,eI.settings,eI.sidePanel),!oP())throw rh;n(aX(e,"settings.setSettings",t))})}function aS(e){return e.appId instanceof ih}function aA(){aR(rH(ad,"pages.backStack.registerBackButtonPressHandler"),"backButtonPress",aE,!1)}function aE(){c&&c()||(aH()?aj("backButtonPress",[]):oZ())}let aI=r_("handlers");class aT{static initializeHandlers(){aT.handlers.themeChange=aN,aT.handlers.load=aD,aT.handlers.beforeUnload=aU,aA()}static uninitializeHandlers(){aT.handlers={},aT.themeChangeHandler=null,aT.loadHandler=null,aT.beforeUnloadHandler=null,aT.beforeSuspendOrTerminateHandler=null,aT.resumeHandler=null}}aT.handlers={},aT.themeChangeHandler=null,aT.loadHandler=null,aT.beforeUnloadHandler=null,aT.beforeSuspendOrTerminateHandler=null,aT.resumeHandler=null,aT.hostToAppPerformanceMetricsHandler=null;let aP=aI.extend("callHandler");function aO(e,t){let n=aT.handlers[e];return n?(aP("Invoking the registered handler for message %s with arguments %o",e,t),[!0,n.apply(this,t)]):(aH()?aj(e,t):aP("Handler for action message %s not found.",e),[!1,void 0])}function aR(e,t,n,r=!0,i=[]){n?(aT.handlers[t]=n,r&&a8(e,"registerHandler",[t,...i])):delete aT.handlers[t]}function aF(e){delete aT.handlers[e]}function ak(e){return null!=aT.handlers[e]}function aM(e,t,n,r,i){n&&ic(rz,...r),i&&i(),aR(e,t,n)}function aN(e){aT.themeChangeHandler&&aT.themeChangeHandler(e),aH()&&aj("themeChange",[e])}function ax(e){aT.hostToAppPerformanceMetricsHandler&&aT.hostToAppPerformanceMetricsHandler(e)}function aD(e){var t;let n={entityId:(t=e).entityId,contentUrl:new URL(t.contentUrl)};aT.resumeHandler?(aT.resumeHandler(n),aH()&&aj("load",[n])):aT.loadHandler&&(aT.loadHandler(e),aH()&&aj("load",[e]))}function aU(){var e,t,n,r;return e=this,t=void 0,n=void 0,r=function*(){let e=()=>{a8(rH("v2","handleBeforeUnload"),"readyToUnload",[])};aT.beforeSuspendOrTerminateHandler?(yield aT.beforeSuspendOrTerminateHandler(),aH()?aj("beforeUnload"):e()):aT.beforeUnloadHandler&&aT.beforeUnloadHandler(e)||(aH()?aj("beforeUnload"):e())},new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})}let aL=r_("childProxyingCommunication");class a_{}function aH(){return!!r2()&&!!a_.window}a_.messageQueue=[];let aV=aL.extend("handleIncomingMessageFromChild");function aB(e,t,n,r){let i=a_.window,o=it({id:e,uuid:t,args:n||[],isPartialResponse:r}),a=a_.origin;i&&a&&(aV("Sending message %s to %s via postMessage, args = %o",ir(o),"child",o.args),i.postMessage(o,a))}function aj(e,t){let n=a_.window,r={func:e,args:t||[]},i=a_.origin;n&&i?n.postMessage(r,i):a_.messageQueue.push(r)}class aW{static storeCallbackInformation(e,t){aW.callbackInformation.set(e,t)}static clearMessages(){aW.callbackInformation.clear()}static deleteMessageInformation(e){aW.callbackInformation.delete(e)}static handleOneWayPerformanceMetrics(e,t,n){let r=e.monotonicTimestamp;r&&n?ax({actionName:e.func,messageDelay:n-r,requestStartedAt:r}):t("Unable to send performance metrics for event %s",e.func)}static handlePerformanceMetrics(e,t,n,r){let i=aW.callbackInformation.get(e);i&&t.monotonicTimestamp&&r?(ax({actionName:i.name,messageDelay:r-t.monotonicTimestamp,requestStartedAt:i.calledAt}),aW.deleteMessageInformation(e)):n("Unable to send performance metrics for callback %s with arguments %o",e.toString(),t.args)}}aW.callbackInformation=new Map;let az=r_("nestedAppAuthUtils"),aq=az.extend("tryPolyfillWithNestedAppAuthBridge"),a$=az.extend("createNestedAppAuthBridge");var aG=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};let aJ=r_("communication");class aK{}class aQ{}function aZ(e,t,...n){return a1(e,t,n).then(([e])=>e)}function aX(e,t,...n){return a1(e,t,n).then(([e,t])=>{if(!e)throw Error(t)})}function aY(e,t,n,...r){return a1(e,t,r).then(([e,t])=>{if(!e)throw Error(t||n)})}function a0(e,t,...n){return a1(e,t,n).then(([e,t])=>{if(e)throw e;return t})}function a1(e,t,n){if(!rV(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return new Promise(r=>{var i;r((i=sn(e,t,n).uuid,new Promise(e=>{aQ.promiseCallbacks.set(i,e)})))})}function a2(e){return e.map(e=>null!=e&&void 0!==e.serialize&&"function"==typeof e.serialize?e.serialize():e)}function a3(e,t,n,r,i){var o;return aG(this,void 0,void 0,function*(){let a=a2(t),[s]=yield a1(r,e,a);if(i&&i(s)||!i&&nG(s))throw Error(`${s.errorCode}, message: ${null!=(o=s.message)?o:"None"}`);if(n.validate(s))return n.deserialize(s);throw Error(`${nH.INTERNAL_ERROR}, message: Invalid response from host - ${JSON.stringify(s)}`)})}function a6(e,t,n,r){var i;return aG(this,void 0,void 0,function*(){let o=a2(t),[a]=yield a1(n,e,o);if(r&&r(a)||!r&&nG(a))throw Error(`${a.errorCode}, message: ${null!=(i=a.message)?i:"None"}`);if(void 0!==a)throw Error(`${nH.INTERNAL_ERROR}, message: Invalid response from host`)})}function a5(e,t,n){var r;if(!rV(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return r=sn(e,t,n).uuid,new Promise((e,t)=>{aQ.portCallbacks.set(r,(n,r)=>{n instanceof MessagePort?e(n):t(r&&r.length>0?r[0]:Error("Host responded without port or error details."))})})}function a8(e,t,n,r){let i;if(n instanceof Function?r=n:n instanceof Array&&(i=n),!rV(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);let o=sn(e,t,i);r&&aQ.callbacks.set(o.uuid,r)}aQ.parentMessageQueue=[],aQ.topMessageQueue=[],aQ.nextMessageId=0,aQ.callbacks=new Map,aQ.promiseCallbacks=new Map,aQ.portCallbacks=new Map,aQ.legacyMessageIdsToUuidMap={};let a4=aJ.extend("sendNestedAuthRequestToTopWindow");function a9(e,t){let n=aK.topWindow,r=function(e,t){let n=aQ.nextMessageId++,r=new rM;return aQ.legacyMessageIdsToUuidMap[n]=r,{id:n,uuid:r,func:"nestedAppAuth.execute",timestamp:Date.now(),monotonicTimestamp:rk(),apiVersionTag:t,args:[],data:e}}(e,t);return a4("Message %s information: %o",ir(r),{actionName:r.func}),se(n,r)}let a7=aJ.extend("sendRequestToTargetWindowHelper");function se(e,t){var n,r;let i=(n=e)===aK.topWindow&&sf()?"top":n===aK.parentWindow?"parent":null,o=r9(t);if(rN.isFramelessWindow)aK.currentWindow&&aK.currentWindow.nativeInterface&&(a7("Sending message %s to %s via framelessPostMessage interface",ir(o),i),aK.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(o)));else{let n=(r=e)===aK.topWindow&&sf()?aK.topOrigin:r===aK.parentWindow?aK.parentOrigin:null;e&&n?(a7("Sending message %s to %s via postMessage",ir(o),i),e.postMessage(o,n)):(a7("Adding message %s to %s message queue",ir(o),i),sp(e).push(t))}return t}let st=aJ.extend("sendMessageToParentHelper");function sn(e,t,n,r,i){let o=aK.parentWindow,a=function(e,t,n,r,i){let o=aQ.nextMessageId++,a=new rM;aQ.legacyMessageIdsToUuidMap[o]=a;let s=!0===r?i:rN.teamsJsInstanceId;return{id:o,uuid:a,func:t,timestamp:Date.now(),monotonicTimestamp:rk(),args:n||[],apiVersionTag:e,isProxiedFromChild:null!=r&&r,teamsJsInstanceId:s}}(e,t,n,r,i);return aW.storeCallbackInformation(a.uuid,{name:t,calledAt:a.timestamp}),st("Message %s information: %o",ir(a),{actionName:t,args:n}),se(o,a)}let sr=aJ.extend("processIncomingMessage"),si=aJ.extend("processAuthBridgeMessage");function so(e,t){var n,r;if(!e||!e.data||"object"!=typeof e.data)return void si("Unrecognized message format received by app, message being ignored. Message: %o",e);let{args:i}=e.data,[,o]=null!=i?i:[],a=(()=>{try{return JSON.parse(o)}catch(e){return null}})();if(!a||"object"!=typeof a||"NestedAppAuthResponse"!==a.messageType)return void si("Unrecognized data format received by app, message being ignored. Message: %o",e);let s=e.source||(null==(n=null==e?void 0:e.originalEvent)?void 0:n.source),l=e.origin||(null==(r=null==e?void 0:e.originalEvent)?void 0:r.origin);s?ss(s,l)?(aK.topWindow&&!aK.topWindow.closed&&s!==aK.topWindow||(aK.topWindow=s,aK.topOrigin=l),aK.topWindow&&aK.topWindow.closed&&(aK.topWindow=null,aK.topOrigin=null),io(aK.topWindow,aK.topOrigin,aQ.topMessageQueue,"top"),t(o)):si("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin"):si("Message being ignored by app because it is coming for a target that is null")}let sa=aJ.extend("shouldProcessIncomingMessage");function ss(e,t){return aG(this,void 0,void 0,function*(){if(aK.currentWindow&&e===aK.currentWindow)return sa("Should not process message because it is coming from the current window"),!1;if(aK.currentWindow&&aK.currentWindow.location&&t&&t===aK.currentWindow.location.origin)return!0;{var n;let e;try{e=new URL(t)}catch(e){return sa("Message has an invalid origin of %s",t),!1}let r=yield(n=e,oz(void 0).then(e=>{if(!rE(n))return oj("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",n,n.protocol),!1;let t=n.host;if(e.some(e=>oq(e,t)))return!0;for(let e of rN.additionalValidOrigins)if(oq("https://"===e.substring(0,8)?e.substring(8):e,t))return!0;return oj("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",n,e,rN.additionalValidOrigins),!1}));return r||sa("Message has an invalid origin of %s",t),r}})}let sl=aJ.extend("handleIncomingMessageFromParent");function su(e,t){if(t){let n=[...e].find(([e,n])=>e.toString()===t.toString());if(n)return n[0]}}function sc(e,t){let n=su(t,e.uuid);n&&t.delete(n),e.uuid?aQ.legacyMessageIdsToUuidMap={}:delete aQ.legacyMessageIdsToUuidMap[e.id]}function sd(e){let t=rk();if("id"in e.data&&"number"==typeof e.data.id){let n=ie(e.data),r=function(e){if(!e.uuid)return aQ.legacyMessageIdsToUuidMap[e.id];{let t=e.uuid,n=su(aQ.callbacks,t);if(n)return n;let r=su(aQ.promiseCallbacks,t);if(r)return r;let i=su(aQ.portCallbacks,t);if(i)return i}sl("Received message %s that failed to produce a callbackId",ir(e))}(n);if(r){let i=aQ.callbacks.get(r);sl("Received a response from parent for message %s",r.toString()),aW.handlePerformanceMetrics(r,n,sl,t),i&&(sl("Invoking the registered callback for message %s with arguments %o",r.toString(),n.args),i.apply(null,[...n.args,n.isPartialResponse]),!0===e.data.isPartialResponse||(sl("Removing registered callback for message %s",r.toString()),sc(n,aQ.callbacks)));let o=aQ.promiseCallbacks.get(r);o&&(sl("Invoking the registered promise callback for message %s with arguments %o",r.toString(),n.args),o(n.args),sl("Removing registered promise callback for message %s",r.toString()),sc(n,aQ.promiseCallbacks));let a=aQ.portCallbacks.get(r);if(a){let t;sl("Invoking the registered port callback for message %s with arguments %o",r.toString(),n.args),e.ports&&e.ports[0]instanceof MessagePort&&(t=e.ports[0]),a(t,n.args),sl("Removing registered port callback for message %s",r.toString()),sc(n,aQ.portCallbacks)}n.uuid&&(aQ.legacyMessageIdsToUuidMap={})}}else if("func"in e.data&&"string"==typeof e.data.func){let n=e.data;aW.handleOneWayPerformanceMetrics(n,sl,t),sl('Received a message from parent %s, action: "%s"',ir(n),n.func),aO(n.func,n.args)}else sl("Received an unknown message: %O",e)}function sf(){return aK.topWindow!==aK.parentWindow}function sp(e){return e===aK.topWindow&&sf()?aQ.topMessageQueue:e===aK.parentWindow?aQ.parentMessageQueue:[]}function sg(e,t){let n;n=aK.currentWindow.setInterval(()=>{0===sp(e).length&&(clearInterval(n),t())},100)}function sm(e){if(iv(e)||ic(rz),!iv(e)&&!sh())throw rh;e?aR(rH("v1","log.request"),"log.request",()=>{let t=e();a8(rH("v1","log.receive"),"log.receive",[t])}):aF("log.request")}function sh(){return!(!ic(rz)||!rz.supports.logs)}function sv(e,t){ic(rz),a8(rH("v1","uploadCustomApp"),"uploadCustomApp",[e],t||rC())}function sw(e,t,n){ic(rz),a8(rH("v1","sendCustomMessage"),e,t,n)}function sy(e,t){if(ic(rz),!aH())throw Error("The child window has not yet been initialized or is not present");aj(e,t)}function sC(e,t){ic(rz),aR(rH("v1","registerCustomHandler"),e,(...e)=>t.apply(this,e))}function sb(e,t){ic(rz),aR(rH("v1","registerUserSettingsChangeHandler"),"userSettingsChange",t,!0,[e])}function sS(e){ic(rz,eI.content,eI.task);let t=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId,e.sizeInBytes];a8(rH("v1","openFilePreview"),"openFilePreview",t)}function sA(e){return new Promise(t=>{if(ic(rz,eI.content),!sT())throw rh;let n=aX(rH("v1","conversations.openConversation"),"conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&aR(rH("v1","conversations.registerStartConversationHandler"),"startConversation",(t,n,r,i)=>{var o;return null==(o=e.onStartConversation)?void 0:o.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:i})}),e.onCloseConversation&&aR(rH("v1","conversations.registerCloseConversationHandler"),"closeConversation",(t,n,r,i)=>{var o;return null==(o=e.onCloseConversation)?void 0:o.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:i})}),t(n)})}function sE(){if(ic(rz,eI.content),!sT())throw rh;a8(rH("v1","conversations.closeConversation"),"conversations.closeConversation"),aF("startConversation"),aF("closeConversation")}function sI(){return new Promise(e=>{if(ic(rz),!sT())throw rh;e(aZ(rH("v1","conversations.getChatMember"),"getChatMembers"))})}function sT(){return!(!ic(rz)||!rz.supports.conversations)}(x=eU||(eU={})).fileDownloadStart="fileDownloadStart",x.fileDownloadComplete="fileDownloadComplete",(D=eL||(eL={})).view="view",D.edit="edit",D.editNew="editNew",(U=e_||(e_={})).fileOpenPreference="fileOpenPreference",U.theme="theme";let sP=r_("copilot");function sO(){var e;return ic(rz)&&!!(null==(e=rz.supports.copilot)?void 0:e.customTelemetry)}function sR(e,t){var n,r,i,o,a;return void 0===t&&(t=null!=(n=rk())?n:Date.now()),r=this,i=void 0,o=void 0,a=function*(){return ic(rz),sP("Sending custom telemetry data to host for stage: %s to record timestamp: %s",e,t),a6("copilot.customTelemetry.sendCustomTelemetryData",[e.toString(),t],rH("v2","copilot.customTelemetry.sendCustomTelemetryData"))},new(o||(o=Promise))(function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof o?r:new o(function(e){e(r)})).then(n,s)}l((a=a.apply(r,i||[])).next())})}let sF=r_("copilot");function sk(){var e,t;return ic(rz)&&(!!(null==(e=rz.hostVersionsInfo)?void 0:e.appEligibilityInformation)||!!(null==(t=rz.supports.copilot)?void 0:t.eligibility))}function sM(){var e,t,n,r,i,o;return n=this,r=void 0,i=void 0,o=function*(){var n;if(ic(rz),!sk())throw Error(`Error code: ${rh.errorCode}, message: Not supported on platform`);if(null==(e=rz.hostVersionsInfo)?void 0:e.appEligibilityInformation)return sF("Eligibility information is already available on runtime."),rz.hostVersionsInfo.appEligibilityInformation;sF("Eligibility information is not available on runtime. Requesting from host.");let r=yield aZ(rH("v2","copilot.eligibility.getEligibilityInfo"),"copilot.eligibility.getEligibilityInfo");if(nG(r))throw Error(`Error code: ${r.errorCode}, message: ${null!=(t=r.message)?t:"Failed to get eligibility information from the host."}`);if(!(void 0!==(n=r).ageGroup&&void 0!==n.cohort&&void 0!==n.userClassification&&void 0!==n.isCopilotEligible&&void 0!==n.isCopilotEnabledRegion&&void 0!==n.isOptedOutByAdmin&&(!n.featureSet||void 0!==n.featureSet.serverFeatures&&void 0!==n.featureSet.uxFeatures)))throw Error("Error deserializing eligibility information");return r},new(i||(i=Promise))(function(e,t){function a(e){try{l(o.next(e))}catch(e){t(e)}}function s(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):((n=t.value)instanceof i?n:new i(function(e){e(n)})).then(a,s)}l((o=o.apply(n,r||[])).next())})}class sN{constructor(e){this.invokeRequest=e}serialize(){return this.invokeRequest}}function sx(e){return e.responseType===eV.ActionExecuteInvokeResponse&&void 0!==e.value&&void 0!==e.statusCode&&void 0!==e.type}let sD="Action.Execute";(L=eH||(eH={})).ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",L.QueryMessageExtensionRequest="QueryMessageExtensionRequest",(_=eV||(eV={})).ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",_.QueryMessageExtensionResponse="QueryMessageExtensionResponse";class sU extends oO{validate(e){return sx(e)}deserialize(e){return e}}function sL(e){return"object"==typeof e&&null!==e&&Object.values(eB).includes(e.errorCode)&&(void 0===e.message||"string"==typeof e.message)}function s_(e){e.requestType===eH.ActionExecuteInvokeRequest?sH(e):e.requestType===eH.QueryMessageExtensionRequest&&function(e){if(e.commandId.length>64)throw Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(e.parameters.length>5)throw Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(let t of e.parameters){if(t.name.length>64)throw Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(t.value.length>512)throw Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}(e)}function sH(e){if(e.type!==sD)throw{errorCode:eB.INTERNAL_ERROR,message:`Invalid action type ${e.type}. Action type must be "${sD}"`};if(!function e(t,n=0){return!(n>1e3)&&(void 0===t||"boolean"==typeof t||"number"==typeof t||"bigint"==typeof t||"string"==typeof t||null===t||(Array.isArray(t)?t.every(t=>e(t,n+1)):"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))&&Object.keys(t).every(r=>e(t[r],n+1))))}(e.data))throw{errorCode:eB.INTERNAL_ERROR,message:`Invalid data type ${typeof e.data}. Data must be a primitive or a plain object.`}}function sV(e,t,n){if(ic(rz,eI.content),!sq())throw rh;let r=new ih(e);return s_(n),a1(rH("v2","externalAppAuthentication.authenticateAndResendRequest"),"externalAppAuthentication.authenticateAndResendRequest",[r.toString(),n,t.url.href,t.width,t.height,t.isExternal]).then(([e,t])=>{if(e&&null!=t.responseType)return t;throw t})}function sB(e,t){if(ic(rz,eI.content),!sq())throw rh;let n=new ih(e);return a1(rH("v2","externalAppAuthentication.authenticateWithSSO"),"externalAppAuthentication.authenticateWithSSO",[n.toString(),t.claims,t.silent]).then(([e,t])=>{if(!e)throw t})}function sj(e,t,n){if(ic(rz,eI.content),!sq())throw rh;let r=new ih(e);return s_(n),a1(rH("v2","externalAppAuthentication.authenticateWithSSOAndResendRequest"),"externalAppAuthentication.authenticateWithSSOAndResendRequest",[r.toString(),n,t.claims,t.silent]).then(([e,t])=>{if(e&&null!=t.responseType)return t;throw t})}function sW(e,t,n){if(ic(rz,eI.content),!sq())throw rh;return rP(e,Error("titleId is Invalid.")),rP(t,Error("oauthConfigId is Invalid.")),a1(rH("v2","externalAppAuthentication.authenticateWithOauth2"),"externalAppAuthentication.authenticateWithOauth2",[e,t,n.width,n.height,n.isExternal]).then(([e,t])=>{if(!e)throw t})}function sz(e,t,n){if(ic(rz,eI.content),!sq())throw rh;return rP(e,Error("titleId is Invalid.")),t&&rO(t),a1(rH("v2","externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins"),"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins",[e,null==t?void 0:t.toString(),null==n?void 0:n.width,null==n?void 0:n.height,null==n?void 0:n.isExternal]).then(([e,t])=>{if(!e)throw t})}function sq(){return!(!ic(rz)||!rz.supports.externalAppAuthentication)}(eB||(eB={})).INTERNAL_ERROR="INTERNAL_ERROR";var s$=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};function sG(e,t,n){return s$(this,void 0,void 0,function*(){if(ic(rz,eI.content),!sZ())throw rh;return sX(e,t),a6("externalAppAuthenticationForCEA.authenticateWithSSO",[e,t,n.authId,n.connectionName,n.claims,n.silent],rH("v2","externalAppAuthenticationForCEA.authenticateWithSSO"),sL)})}function sJ(e,t,n){return s$(this,void 0,void 0,function*(){if(ic(rz,eI.content),!sZ())throw rh;return sX(e,t),a6("externalAppAuthenticationForCEA.authenticateWithOauth",[e,t,n.url.href,n.width,n.height,n.isExternal],rH("v2","externalAppAuthenticationForCEA.authenticateWithOauth"),sL)})}function sK(e,t,n,r){return s$(this,void 0,void 0,function*(){if(ic(rz,eI.content),!sZ())throw rh;return sX(e,t),sH(r),a3("externalAppAuthenticationForCEA.authenticateAndResendRequest",[e,t,new sN(r),n.url.href,n.width,n.height,n.isExternal],new sU,rH("v2","externalAppAuthenticationForCEA.authenticateAndResendRequest"),sL)})}function sQ(e,t,n,r){return s$(this,void 0,void 0,function*(){if(ic(rz,eI.content),!sZ())throw rh;return sX(e,t),sH(r),a3("externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest",[e,t,new sN(r),n.authId,n.connectionName,n.claims,n.silent],new sU,rH("v2","externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest"),sL)})}function sZ(){return!(!ic(rz)||!rz.supports.externalAppAuthenticationForCEA)}function sX(e,t){rP(t,Error("conversation id is not valid.")),ig(e)}function sY(e,t){if(ic(rz,eI.content),!s1())throw rh;let n=new ih(e);return a1(rH("v2","externalAppCardActions.processActionSubmit"),"externalAppCardActions.processActionSubmit",[n.toString(),t]).then(([e,t])=>{if(!e)throw t})}function s0(e,t,n){if(ic(rz,eI.content),!s1())throw rh;let r=new ih(e);return a1(rH("v2","externalAppCardActions.processActionOpenUrl"),"externalAppCardActions.processActionOpenUrl",[r.toString(),t.href,n]).then(([e,t])=>{if(e)throw e;return t})}function s1(){return!(!ic(rz)||!rz.supports.externalAppCardActions)}(H=ej||(ej={})).DeepLinkDialog="DeepLinkDialog",H.DeepLinkOther="DeepLinkOther",H.DeepLinkStageView="DeepLinkStageView",H.GenericUrl="GenericUrl",(V=eW||(eW={})).INTERNAL_ERROR="INTERNAL_ERROR",V.INVALID_LINK="INVALID_LINK",V.NOT_SUPPORTED="NOT_SUPPORTED";var s2=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};function s3(e,t,n){return s2(this,void 0,void 0,function*(){if(ic(rz,eI.content),!s5())throw rh;sX(e,t);let[r,i]=yield a1(rH("v2","externalAppCardActionsForCEA.processActionOpenUrl"),"externalAppCardActionsForCEA.processActionOpenUrl",[e.toString(),t,n.href]);if(r)throw r;return i})}function s6(e,t,n){return s2(this,void 0,void 0,function*(){if(ic(rz,eI.content),!s5())throw rh;sX(e,t);let r=yield aZ(rH("v2","externalAppCardActionsForCEA.processActionSubmit"),"externalAppCardActionsForCEA.processActionSubmit",e.toString(),t,n);if(r)throw r})}function s5(){return!(!ic(rz)||!rz.supports.externalAppCardActionsForCEA)}function s8(e){return"object"==typeof e&&null!==e&&Object.values(ez).includes(e.errorCode)&&(void 0===e.message||"string"==typeof e.message)}function s4(e,t,n){var r,i,o,a;return r=this,i=void 0,o=void 0,a=function*(){var r,i;if(ic(rz,eI.content),!s9())throw rh;return r=e,i=n,ig(r),function(e){if(!(e instanceof rM))throw Error(`Potential id (${JSON.stringify(e)}) is invalid; it is not an instance of UUID class.`)}(i),a6("externalAppCardActionsForDA.processActionOpenUrlDialog",[e,new s7(t),n],rH("v2","externalAppCardActionsForDA.processActionOpenUrlDialog"),s8)},new(o||(o=Promise))(function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof o?r:new o(function(e){e(r)})).then(n,s)}l((a=a.apply(r,i||[])).next())})}function s9(){return!(!ic(rz)||!rz.supports.externalAppCardActionsForDA)}(ez||(ez={})).INTERNAL_ERROR="INTERNAL_ERROR";class s7{constructor(e){this.info=e}serialize(){let{url:e,title:t,size:n}=this.info;return{url:e.href,title:t,size:n}}}function le(e,t,n){var r,i,o,a;return r=this,i=void 0,o=void 0,a=function*(){if(ic(rz,eI.content),!lt())throw rh;let r=new ih(e),[i,o]=yield a1(rH("v2","externalAppCommands.processActionCommand"),"externalAppCommands.processActionCommand",[r.toString(),t,n]);if(i)throw i;return o},new(o||(o=Promise))(function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof o?r:new o(function(e){e(r)})).then(n,s)}l((a=a.apply(r,i||[])).next())})}function lt(){return!(!ic(rz)||!rz.supports.externalAppCommands)}function ln(e,t){if(ic(rz,eI.content),!e||0===e.length)throw Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw Error("[files.getCloudStorageFolders] Callback cannot be null");a8(rH("v1","files.getCloudStorageFolders"),"files.getCloudStorageFolders",[e],t)}function lr(e,t){if(ic(rz,eI.content),!e||0===e.length)throw Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw Error("[files.addCloudStorageFolder] Callback cannot be null");a8(rH("v1","files.addCloudStorageFolder"),"files.addCloudStorageFolder",[e],t)}function li(e,t,n){if(ic(rz,eI.content),!e)throw Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw Error("[files.deleteCloudStorageFolder] Callback cannot be null");a8(rH("v1","files.deleteCloudStorageFolder"),"files.deleteCloudStorageFolder",[e,t],n)}function lo(e,t,n){if(ic(rz,eI.content),!e||!t)throw Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");a8(rH("v1","files.getCloudStorageFolderContents"),"files.getCloudStorageFolderContents",[e,t],n)}function la(e,t,n){if(ic(rz,eI.content),!e||!t)throw Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw Error("[files.openCloudStorageFile] provided file is a subDirectory");a8(rH("v1","files.openCloudStorageFile"),"files.openCloudStorageFile",[e,t,n])}function ls(e=!1,t){if(ic(rz,eI.content),!t)throw Error("[files.getExternalProviders] Callback cannot be null");a8(rH("v1","files.getExternalProviders"),"files.getExternalProviders",[e],t)}function ll(e,t,n,r,i=!1,o){if(ic(rz,eI.content),!e||0===e.length)throw Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!n)throw Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!r)throw Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!o)throw Error("[files.copyMoveFiles] callback cannot be null");a8(rH("v1","files.copyMoveFiles"),"files.copyMoveFiles",[e,t,n,r,i],o)}function lu(e){if(ic(rz,eI.content),!e)throw Error("[files.getFileDownloads] Callback cannot be null");a8(rH("v1","files.getFileDownloads"),"files.getFileDownloads",[],e)}function lc(e,t){if(ic(rz,eI.content),!t)throw Error("[files.openDownloadFolder] Callback cannot be null");a8(rH("v1","files.openDownloadFolder"),"files.openDownloadFolder",[e],t)}function ld(e){if(ic(rz,eI.content),!e)throw lC(nH.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");a8(rH("v1","files.addCloudStorageProvider"),"files.addCloudStorageProvider",[],e)}function lf(e,t){if(ic(rz,eI.content),!t)throw lC(nH.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw lC(nH.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");a8(rH("v1","files.removeCloudStorageProvider"),"files.removeCloudStorageProvider",[e],t)}function lp(e,t){if(ic(rz,eI.content),!t)throw lC(nH.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw lC(nH.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");a8(rH("v1","files.addCloudStorageProviderFile"),"files.addCloudStorageProviderFile",[e],t)}function lg(e,t){if(ic(rz,eI.content),!t)throw lC(nH.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw lC(nH.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");a8(rH("v1","files.renameCloudStorageProviderFile"),"files.renameCloudStorageProviderFile",[e],t)}function lm(e,t){if(ic(rz,eI.content),!t)throw lC(nH.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw lC(nH.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");a8(rH("v1","files.deleteCloudStorageProviderFile"),"files.deleteCloudStorageProviderFile",[e],t)}function lh(e,t){if(ic(rz,eI.content),!t)throw lC(nH.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw lC(nH.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");a8(rH("v1","files.downloadCloudStorageProviderFile"),"files.downloadCloudStorageProviderFile",[e],t)}function lv(e,t){if(ic(rz,eI.content),!t)throw lC(nH.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw lC(nH.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw lC(nH.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");a8(rH("v1","files.uploadCloudStorageProviderFile"),"files.uploadCloudStorageProviderFile",[e],t)}function lw(e){if(ic(rz),!e)throw Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");aR(rH("v1","files.registerCloudStorageProviderListChangeHandler"),"files.cloudStorageProviderListChange",e)}function ly(e){if(ic(rz),!e)throw Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");aR(rH("v1","files.registerCloudStorageProviderContentChangeHandler"),"files.cloudStorageProviderContentChange",e)}function lC(e,t){return{errorCode:e,message:t}}function lb(){return new Promise(e=>{if(ic(rz),!lI())throw rh;e(a0(rH("v1","meetingRoom.getPairedMeetingRoomInfo"),"meetingRoom.getPairedMeetingRoomInfo"))})}function lS(e){return new Promise(t=>{if(!e||0==e.length)throw Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(ic(rz),!lI())throw rh;t(a0(rH("v1","meetingRoom.sendCommandToPairedMeetingRoom"),"meetingRoom.sendCommandToPairedMeetingRoom",e))})}function lA(e){if(!e)throw Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(ic(rz),!lI())throw rh;aR(rH("v1","meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler"),"meetingRoom.meetingRoomCapabilitiesUpdate",t=>{ic(rz),e(t)})}function lE(e){if(!e)throw Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(ic(rz),!lI())throw rh;aR(rH("v1","meetingRoom.registerMeetingRoomStatesUpdateHandler"),"meetingRoom.meetingRoomStatesUpdate",t=>{ic(rz),e(t)})}function lI(){return!(!ic(rz)||!rz.supports.meetingRoom)}function lT(){return!(!ic(rz)||!rz.supports.messageChannels)}(B=eq||(eq={})).Dropbox="DROPBOX",B.Box="BOX",B.Sharefile="SHAREFILE",B.GoogleDrive="GOOGLEDRIVE",B.Egnyte="EGNYTE",B.SharePoint="SharePoint",(j=e$||(e$={}))[j.Sharepoint=0]="Sharepoint",j[j.WopiIntegration=1]="WopiIntegration",j[j.Google=2]="Google",j[j.OneDrive=3]="OneDrive",j[j.Recent=4]="Recent",j[j.Aggregate=5]="Aggregate",j[j.FileSystem=6]="FileSystem",j[j.Search=7]="Search",j[j.AllFiles=8]="AllFiles",j[j.SharedWithMe=9]="SharedWithMe",(eG||(eG={})).ClassMaterials="classMaterials",(eJ||(eJ={})).Readonly="readonly",(W=eK||(eK={})).Downloaded="Downloaded",W.Downloading="Downloading",W.Failed="Failed",(z=eQ||(eQ={})).Download="DOWNLOAD",z.Upload="UPLOAD",z.Delete="DELETE";let lP="1.0.0",lO={onMessage:function(e,t){if(!e||!e.data||"object"!=typeof e.data||null===e.data)return void lM("Invalid message format, ignoring. Message: %o",e);if(!function(e,t){if(e&&e!==window.top)return lM("Should not process message because it is not coming from the top window"),!1;if(t===lR)try{return"https:"===new URL(t).protocol}catch(e){return lN("Invalid message origin URL:",e),!1}return!1}(e.source,e.origin))return void lM("Message source/origin not allowed, ignoring.");let{args:n}=e.data,[,r]=null!=n?n:[],i=(()=>{try{return JSON.parse(r)}catch(e){return lN("Failed to parse response message:",e),null}})();if(!i||"NestedAppAuthResponse"!==i.messageType)return void lM("Invalid response format, ignoring. Message: %o",e);t(r)}},lR=null,lF=!1;function lk(e,t,n=!1){if(lF=n,!e)throw Error("Cannot polyfill nestedAppAuthBridge as the current window does not exist");if(!t)throw Error("Top origin is required to initialize the Nested App Auth Bridge");try{let e=new URL(t);if("https:"!==e.protocol)throw Error(`Invalid top origin: ${t}. Only HTTPS origins are allowed.`);lR=e.origin}catch(e){throw Error(`Failed to initialize bridge: invalid top origin: ${t}`)}if(e.nestedAppAuthBridge)return void lM("Nested App Auth Bridge is already present");let r=function(e){let t=new WeakMap,{onMessage:n}=lO,r=e=>t=>n(t,e);return{addEventListener:(n,i)=>{if("message"===n){let o=r(i);t.set(i,o),e.addEventListener(n,o)}else lM(`Event ${n} is not supported by nestedAppAuthBridge`)},postMessage:t=>{if(!e.top)throw Error("window.top is not available for posting messages");try{let n=JSON.parse(t);if("object"==typeof n&&"NestedAppAuthRequest"===n.messageType){let n=function(e){let t=Date.now();return{id:"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).substring(2,11),uuid:rp(),func:"nestedAppAuth.execute",timestamp:t,apiVersionTag:"v2_nestedAppAuth.execute",monotonicTimestamp:t,args:[],data:e}}(t);if(e===e.top||!lR)return void lN("Not in an embedded iframe; skipping postMessage.");e.top.postMessage(n,lR)}}catch(e){return void lN("Failed to parse message:",e,"Original message:",t)}},removeEventListener:(n,r)=>{let i=t.get(r);i&&(e.removeEventListener(n,i),t.delete(r))}}}(e);r&&(e.nestedAppAuthBridge=r)}function lM(...e){lF&&console.log(...e)}function lN(...e){lF&&console.error(...e)}function lx(e){if(ic(rz,eI.content),!lD())throw rh;a8(rH("v1","notifications.showNotification"),"notifications.showNotification",[e])}function lD(){return!(!ic(rz)||!rz.supports.notifications)}function lU(e){if(!lH())throw Error(nH.NOT_SUPPORTED_ON_PLATFORM.toString());if(iv(e))throw Error(nH.INVALID_ARGUMENTS.toString());aR(rH("v2","otherApp.install"),"otherApp.install",e)}function lL(){if(!lH())throw Error(nH.NOT_SUPPORTED_ON_PLATFORM.toString());a8(rH("v2","otherApp.unregisterInstall"),"otherApp.unregisterInstall"),aF("otherApp.install")}function l_(e){if(!lH())throw Error(nH.NOT_SUPPORTED_ON_PLATFORM.toString());return a6("otherApp.notifyInstallCompleted",[e.toString()],rH("v2","otherApp.notifyInstallCompleted"))}function lH(){return!(!ic(rz)||!rz.supports.otherAppStateChange)}function lV(e){if(!e)throw Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(ic(rz,eI.sidePanel),!lJ())throw rh;a8(rH("v1","remoteCamera.getCapableParticipants"),"remoteCamera.getCapableParticipants",e)}function lB(e,t){if(!e)throw Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw Error("[remoteCamera.requestControl] Callback cannot be null");if(ic(rz,eI.sidePanel),!lJ())throw rh;a8(rH("v1","remoteCamera.requestControl"),"remoteCamera.requestControl",[e],t)}function lj(e,t){if(!e)throw Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(ic(rz,eI.sidePanel),!lJ())throw rh;a8(rH("v1","remoteCamera.sendControlCommand"),"remoteCamera.sendControlCommand",[e],t)}function lW(e){if(!e)throw Error("[remoteCamera.terminateSession] Callback cannot be null");if(ic(rz,eI.sidePanel),!lJ())throw rh;a8(rH("v1","remoteCamera.terminateSession"),"remoteCamera.terminateSession",e)}function lz(e){if(!e)throw Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(ic(rz,eI.sidePanel),!lJ())throw rh;aR(rH("v1","remoteCamera.registerOnCapableParticipantsChangeHandler"),"remoteCamera.capableParticipantsChange",e)}function lq(e){if(!e)throw Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(ic(rz,eI.sidePanel),!lJ())throw rh;aR(rH("v1","remoteCamera.registerOnErrorHandler"),"remoteCamera.handlerError",e)}function l$(e){if(!e)throw Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(ic(rz,eI.sidePanel),!lJ())throw rh;aR(rH("v1","remoteCamera.registerOnDeviceStateChangeHandler"),"remoteCamera.deviceStateChange",e)}function lG(e){if(!e)throw Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(ic(rz,eI.sidePanel),!lJ())throw rh;aR(rH("v1","remoteCamera.registerOnSessionStatusChangeHandler"),"remoteCamera.sessionStatusChange",e)}function lJ(){return!(!ic(rz)||!rz.supports.remoteCamera)}function lK(e,t,n,r){if(ic(rz,eI.content),!lQ())throw rh;if(!e||0==e.length)throw Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!r)throw Error("[appEntity.selectAppEntity] Callback cannot be null");a8(rH("v1","appEntity.selectAppEntity"),"appEntity.selectAppEntity",[e,t,n],r)}function lQ(){return!(!ic(rz)||!rz.supports.appEntity)}function lZ(e){return new Promise(t=>{if(ic(rz),!lX())throw rh;if((rN.hostClientType===eA.android||rN.hostClientType===eA.teamsRoomsAndroid||rN.hostClientType===eA.teamsPhones||rN.hostClientType===eA.teamsDisplays)&&!id("2.0.1"))throw Error(JSON.stringify({errorCode:nH.OLD_PLATFORM}));t(aZ(rH("v1","teams.fullTrust.joinedTeams.getUserJoinedTeams"),"getUserJoinedTeams",e))})}function lX(){return!(!ic(rz)||!rz.supports.teams)&&!!rz.supports.teams.fullTrust&&!!rz.supports.teams.fullTrust.joinedTeams}function lY(e){return new Promise(t=>{if(ic(rz),!l0())throw rh;t(aZ(rH("v1","teams.fullTrust.getConfigSetting"),"getConfigSetting",e))})}function l0(){return!(!ic(rz)||!rz.supports.teams)&&!!rz.supports.teams.fullTrust}function l1(e,t){if(ic(rz,eI.content),!l3())throw rh;if(!e)throw Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw Error("[teams.getTeamChannels] Callback cannot be null");a8(rH("v1","teams.getTeamChannels"),"teams.getTeamChannels",[e],t)}function l2(e,t){if(ic(rz),!l3())throw rh;if(!e)throw Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw Error("[teams.refreshSiteUrl] Callback cannot be null");a8(rH("v1","teams.refreshSiteUrl"),"teams.refreshSiteUrl",[e],t)}function l3(){return!(!ic(rz)||!rz.supports.teams)}(q=eZ||(eZ={})).Reset="Reset",q.ZoomIn="ZoomIn",q.ZoomOut="ZoomOut",q.PanLeft="PanLeft",q.PanRight="PanRight",q.TiltUp="TiltUp",q.TiltDown="TiltDown",($=eX||(eX={}))[$.CommandResetError=0]="CommandResetError",$[$.CommandZoomInError=1]="CommandZoomInError",$[$.CommandZoomOutError=2]="CommandZoomOutError",$[$.CommandPanLeftError=3]="CommandPanLeftError",$[$.CommandPanRightError=4]="CommandPanRightError",$[$.CommandTiltUpError=5]="CommandTiltUpError",$[$.CommandTiltDownError=6]="CommandTiltDownError",$[$.SendDataError=7]="SendDataError",(G=eY||(eY={}))[G.None=0]="None",G[G.ControlDenied=1]="ControlDenied",G[G.ControlNoResponse=2]="ControlNoResponse",G[G.ControlBusy=3]="ControlBusy",G[G.AckTimeout=4]="AckTimeout",G[G.ControlTerminated=5]="ControlTerminated",G[G.ControllerTerminated=6]="ControllerTerminated",G[G.DataChannelError=7]="DataChannelError",G[G.ControllerCancelled=8]="ControllerCancelled",G[G.ControlDisabled=9]="ControlDisabled",G[G.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController",(J=e0||(e0={}))[J.Regular=0]="Regular",J[J.Private=1]="Private",J[J.Shared=2]="Shared";class l6{static setTimeout(e,t){let n=performance.now(),r=rp();return l6.setTimeoutCallbacks[r]={callback:e,timeoutInMs:t,startedAtInMs:n},r}static clearTimeout(e){delete l6.setTimeoutCallbacks[e]}static setInterval(e,t){l6.setTimeout(function n(){e(),l6.setTimeout(n,t)},t)}static tick(){let e=performance.now(),t=[];for(let n in l6.setTimeoutCallbacks){let r=l6.setTimeoutCallbacks[n];e-r.startedAtInMs>=r.timeoutInMs&&t.push(n)}for(let e of t)l6.setTimeoutCallbacks[e].callback(),delete l6.setTimeoutCallbacks[e]}}l6.setTimeoutCallbacks={};class l5{constructor(e,t){this.reportStatisticsResult=t,this.sampleCount=0,this.distributionBins=new Uint32Array(e)}processStarts(e,t,n,r){l6.tick(),this.suitableForThisSession(e,t,n,r)||this.reportAndResetSession(this.getStatistics(),e,r,t,n),this.start()}processEnds(){let e=performance.now()-this.frameProcessingStartedAt,t=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,e)));this.distributionBins[t]+=1,this.sampleCount+=1}getStatistics(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null}start(){this.frameProcessingStartedAt=performance.now()}suitableForThisSession(e,t,n,r){return this.currentSession&&this.currentSession.effectId===e&&this.currentSession.effectParam===r&&this.currentSession.frameWidth===t&&this.currentSession.frameHeight===n}reportAndResetSession(e,t,n,r,i){e&&this.reportStatisticsResult(e),this.resetCurrentSession(this.getNextTimeout(t,this.currentSession),t,n,r,i),this.timeoutId&&l6.clearTimeout(this.timeoutId),this.timeoutId=l6.setTimeout((()=>this.reportAndResetSession(this.getStatistics(),t,n,r,i)).bind(this),this.currentSession.timeoutInMs)}resetCurrentSession(e,t,n,r,i){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:e,effectId:t,effectParam:n,frameWidth:r,frameHeight:i},this.sampleCount=0,this.distributionBins.fill(0)}getNextTimeout(e,t){return t&&t.effectId===e?Math.min(l5.maxSessionTimeoutInMs,2*t.timeoutInMs):l5.initialSessionTimeoutInMs}}l5.initialSessionTimeoutInMs=1e3,l5.maxSessionTimeoutInMs=3e4;class l8{constructor(e){this.reportPerformanceEvent=e,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new l5(l8.distributionBinSize,e=>this.reportPerformanceEvent(rH("v2","videoPerformanceMonitor.performanceDataGenerated"),"video.performance.performanceDataGenerated",[e]))}startMonitorSlowFrameProcessing(){l6.setInterval(()=>{if(0===this.processedFrameCount)return;let e=this.frameProcessingTimeCost/this.processedFrameCount;e>this.frameProcessTimeLimit&&this.reportPerformanceEvent(rH("v2","videoPerformanceMonitor.startMonitorSlowFrameProcessing"),"video.performance.frameProcessingSlow",[e]),this.frameProcessingTimeCost=0,this.processedFrameCount=0},l8.calculateFPSInterval)}setFrameProcessTimeLimit(e){this.frameProcessTimeLimit=e}reportApplyingVideoEffect(e,t){var n,r;(null==(n=this.applyingEffect)?void 0:n.effectId)===e&&(null==(r=this.applyingEffect)?void 0:r.effectParam)===t||(this.applyingEffect={effectId:e,effectParam:t},this.appliedEffect=void 0)}reportVideoEffectChanged(e,t){void 0===this.applyingEffect||this.applyingEffect.effectId!==e&&this.applyingEffect.effectParam!==t||(this.appliedEffect={effectId:e,effectParam:t},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)}reportStartFrameProcessing(e,t){l6.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,e,t,this.appliedEffect.effectParam))}reportFrameProcessed(){var e;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent(rH("v2","videoPerformanceMonitor.reportFrameProcessed"),"video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null==(e=this.appliedEffect)?void 0:e.effectParam])))}reportGettingTextureStream(e){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=e}reportTextureStreamAcquired(){if(void 0!==this.gettingTextureStreamStartedAt){let e=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent(rH("v2","videoPerformanceMonitor.reportTextureStreamAcquired"),"video.performance.textureStreamAcquired",[this.currentStreamId,e])}}}l8.distributionBinSize=1e3,l8.calculateFPSInterval=1e3;var l4=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})},l9=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};let l7=rT()?void 0:new l8(a8);function ue(e){if(ic(rz,eI.sidePanel),!ui())throw rh;if(!e.videoFrameHandler||!e.videoBufferHandler)throw Error("Both videoFrameHandler and videoBufferHandler must be provided");if(aR(rH("v2","videoEffects.setFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",e=>null==l7?void 0:l7.setFrameProcessTimeLimit(e.timeLimit),!1),uo())!function(e,t){if(ic(rz,eI.sidePanel),!ui()||!uo())throw rh;aR(rH("v2","videoEffects.startVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",t=>l4(this,void 0,void 0,function*(){let{streamId:n}=t,r=function(e,t){return n=>l4(this,void 0,void 0,function*(){let r=n.videoFrame;null==t||t.reportStartFrameProcessing(r.codedWidth,r.codedHeight);let i=yield e(n);return null==t||t.reportFrameProcessed(),i})}(e,l7);yield ul(n,r,ur,l7)}),!1),a8(rH("v2","videoEffects.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[t])}(e.videoFrameHandler,e.config);else{if(!ua())throw rh;var t=e.videoBufferHandler,n=e.config;if(ic(rz,eI.sidePanel),!ui()||!ua())throw rh;aR(rH("v2","videoEffects.registerForVideoBufferHandler"),"video.newVideoFrame",e=>{if(e){let n=e.timestamp;null==l7||l7.reportStartFrameProcessing(e.width,e.height),t(function(e){if("videoFrameBuffer"in e)return e;{let{data:t}=e;return Object.assign(Object.assign({},l9(e,["data"])),{videoFrameBuffer:t})}}(e),()=>{null==l7||l7.reportFrameProcessed(),a8(rH("v2","videoEffects.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[n])},ur)}},!1),a8(rH("v2","videoEffects.registerForVideoFrame"),"video.registerForVideoFrame",[n])}null==l7||l7.startMonitorSlowFrameProcessing()}function ut(e,t){if(ic(rz,eI.sidePanel),!ui())throw rh;a8(rH("v2","videoEffects.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t])}function un(e){if(ic(rz,eI.sidePanel),!ui())throw rh;aR(rH("v2","videoEffects.registerEffectParameterChangeHandler"),"video.effectParameterChange",uh(e,l7),!1),a8(rH("v2","videoEffects.registerForVideoEffect"),"video.registerForVideoEffect")}function ur(e){a8(rH("v2","videoEffects.notifyError"),"video.notifyError",[e])}function ui(){return ic(rz)&&!!rz.supports.video&&(!!rz.supports.video.mediaStream||!!rz.supports.video.sharedFrame)}function uo(){var e,t,n,r,i;return ic(rz,eI.sidePanel)&&!(!(null==(n=null==(t=rI().chrome)?void 0:t.webview)?void 0:n.getTextureStream)||!(null==(i=null==(r=rI().chrome)?void 0:r.webview)?void 0:i.registerTextureStream))&&!!(null==(e=rz.supports.video)?void 0:e.mediaStream)}function ua(){var e;return ic(rz,eI.sidePanel)&&!!(null==(e=rz.supports.video)?void 0:e.sharedFrame)}(e1||(e1={})).NV12="NV12",(K=e2||(e2={})).EffectChanged="EffectChanged",K.EffectDisabled="EffectDisabled",(Q=e3||(e3={})).InvalidEffectId="InvalidEffectId",Q.InitializationFailure="InitializationFailure";var us=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};function ul(e,t,n,r){var i,o;return us(this,void 0,void 0,function*(){let a=uc();rT()||null==(o=null==(i=window.chrome)?void 0:i.webview)||o.registerTextureStream(e,a),ud((yield uu(e,n,r)),new uf(n,t),a.writable)})}function uu(e,t,n){return us(this,void 0,void 0,function*(){if(rT())throw rh;let r=rI().chrome;try{null==n||n.reportGettingTextureStream(e);let t=(yield r.webview.getTextureStream(e)).getVideoTracks();if(0===t.length)throw Error(`No video track in stream ${e}`);return null==n||n.reportTextureStreamAcquired(),t[0]}catch(n){throw t(`Failed to get video track from stream ${e}, error: ${n}`),Error(`Internal error: can't get video track from stream ${e}`)}})}function uc(){if(rT())throw rh;let e=window.MediaStreamTrackGenerator;if(!e)throw rh;return new e({kind:"video"})}function ud(e,t,n){new(0,rI().MediaStreamTrackProcessor)({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(n)}class uf{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.transform=(e,t)=>us(this,void 0,void 0,function*(){let n=e.timestamp;if(null!==n)try{let r=yield this.videoFrameHandler({videoFrame:e}),i=new VideoFrame(r,{timestamp:n});t.enqueue(i),e.close(),r.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")})}}class up{constructor(e,t){if(this.headerBuffer=e,this.notifyError=t,this.ONE_TEXTURE_INPUT_ID=0x6f746931,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(e),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),Error(this.UNSUPPORTED_LAYOUT_ERROR)}get oneTextureLayoutId(){return this.headerDataView[0]}get version(){return this.headerDataView[1]}get frameRowOffset(){return this.headerDataView[2]}get frameFormat(){return this.headerDataView[3]}get frameWidth(){return this.headerDataView[4]}get frameHeight(){return this.headerDataView[5]}get multiStreamHeaderRowOffset(){return this.headerDataView[6]}get multiStreamCount(){return this.headerDataView[7]}}class ug{constructor(e,t){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=0x31646961,this.ATTRIBUTE_ID_MAP_STREAM_ID=0x4d444941;let n=new Uint32Array(e);for(let r=0,i=0;r<t;r++){let t=n[i++],r=new Uint8Array(e,n[i++],n[i++]);this.metadataMap.set(t,r)}}get audioInferenceResult(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}get attributes(){let e=this.metadataMap.get(this.ATTRIBUTE_ID_MAP_STREAM_ID);if(void 0===e)return;let t=new Map,n=new TextDecoder("utf-8"),r=0,i=e[0]+(e[++r]<<8)+(e[++r]<<16)+(e[++r]<<24);for(let o=0;o<i&&r<e.length-1;o++){let i=e[++r]+(e[++r]<<8)+(e[++r]<<16)+(e[++r]<<24),o=e.findIndex((e,t,n)=>0==e&&t>r),a=n.decode(e.slice(++r,o)),s=this.metadataMap.get(i);void 0!==s&&t.set(a,s),r=o+(4-(o-r)%4-1)}return t}}class um{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.shouldDiscardAudioInferenceResult=!1,this.transform=(e,t)=>us(this,void 0,void 0,function*(){let n=e.timestamp;if(null!==n)try{let{videoFrame:r,metadata:{audioInferenceResult:i,attributes:o}={}}=yield this.extractVideoFrameAndMetadata(e),a=yield this.videoFrameHandler({videoFrame:r,audioInferenceResult:i,attributes:o}),s=new VideoFrame(a,{timestamp:n});t.enqueue(s),r.close(),e.close(),a.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")}),this.extractVideoFrameAndMetadata=e=>us(this,void 0,void 0,function*(){if(rT())throw rh;if("NV12"!==e.format)throw this.notifyError("Unsupported video frame pixel format"),Error("Unsupported video frame pixel format");let t={x:0,y:0,width:e.codedWidth,height:2},n=new ArrayBuffer(t.width*t.height*3/2);yield e.copyTo(n,{rect:t});let r=new up(n,this.notifyError),i={x:0,y:r.multiStreamHeaderRowOffset,width:e.codedWidth,height:e.codedHeight-r.multiStreamHeaderRowOffset},o=new ArrayBuffer(i.width*i.height*3/2);yield e.copyTo(o,{rect:i});let a=new ug(o,r.multiStreamCount);return{videoFrame:new VideoFrame(e,{timestamp:e.timestamp,visibleRect:{x:0,y:r.frameRowOffset,width:r.frameWidth,height:r.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:a.audioInferenceResult,attributes:a.attributes}}}),aR(rH("v2","videoEffectsUtils.transformerWithMetadata.constructor"),"video.mediaStream.audioInferenceDiscardStatusChange",({discardAudioInferenceResult:e})=>{this.shouldDiscardAudioInferenceResult=e})}}function uh(e,t){return(n,r)=>{null==t||t.reportApplyingVideoEffect(n||"",r),e(n,r).then(()=>{null==t||t.reportVideoEffectChanged(n||"",r),a8(rH("v2","videoEffectsUtils.reportVideoEffectChanged"),"video.videoEffectReadiness",[!0,n,void 0,r])}).catch(e=>{let t=e in e3?e:e3.InitializationFailure;a8(rH("v2","videoEffectsUtils.effectFailure"),"video.videoEffectReadiness",[!1,n,t,r])})}}var uv=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};let uw=2e3,uy=rT()?void 0:new l8(a8);function uC(e){var t,n;if(!uI())throw rh;if(!e.videoFrameHandler||!e.videoBufferHandler)throw Error("Both videoFrameHandler and videoBufferHandler must be provided");if(ic(rz,eI.sidePanel)){if(aR(rH("v2","videoEffectsEX.registerSetFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",e=>null==uy?void 0:uy.setFrameProcessTimeLimit(e),!1),null==(t=rz.supports.video)?void 0:t.mediaStream)aR(rH("v2","videoEffectsEX.registerStartVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",t=>uv(this,void 0,void 0,function*(){let{streamId:n,metadataInTexture:r}=t,i=uy?function(e,t){return n=>uv(this,void 0,void 0,function*(){let r=n.videoFrame;t.reportStartFrameProcessing(r.codedWidth,r.codedHeight);let i=ub(),o=yield e(n);return i(),t.reportFrameProcessed(),o})}(e.videoFrameHandler,uy):e.videoFrameHandler;r?yield function(e,t,n,r){var i,o;return us(this,void 0,void 0,function*(){let a=uc();rT()||null==(o=null==(i=window.chrome)?void 0:i.webview)||o.registerTextureStream(e,a),ud((yield uu(e,n,r)),new um(n,t),a.writable)})}(n,i,uT,uy):yield ul(n,i,uT,uy)}),!1),a8(rH("v2","videoEffectsEX.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[e.config]);else{if(!(null==(n=rz.supports.video)?void 0:n.sharedFrame))throw rh;aR(rH("v2","videoEffectsEx.registerNewVideoFrameHandler"),"video.newVideoFrame",t=>{if(t){var n;null==uy||uy.reportStartFrameProcessing(t.width,t.height);let r=ub(),i=t.timestamp;e.videoBufferHandler(((n=t).videoFrameBuffer=n.videoFrameBuffer||n.data,delete n.data,n),()=>{var e;r(),null==uy||uy.reportFrameProcessed(),e=i,a8(rH("v2","videoEffectsEx.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[e])},uT)}},!1),a8(rH("v2","videoEffectsEx.registerForVideoFrame"),"video.registerForVideoFrame",[e.config])}null==uy||uy.startMonitorSlowFrameProcessing()}}function ub(){let e=setTimeout(()=>{uT(`Frame not processed in ${uw}ms`,e6.Warn)},uw);return function(){clearTimeout(e)}}function uS(e,t,n){if(ic(rz,eI.sidePanel),!uI())throw rh;a8(rH("v2","videoEffectsEx.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t,n])}function uA(e){if(ic(rz,eI.sidePanel),!uI())throw rh;aR(rH("v2","videoEffectsEx.registerEffectParamterChangeHandler"),"video.effectParameterChange",uh(e,uy),!1),a8(rH("v2","videoEffectsEx.registerForVideoEffect"),"video.registerForVideoEffect")}function uE(e){if(ic(rz,eI.sidePanel),!ui())throw rh;a8(rH("v2","videoEffectsEx.updatePersonalizedEffects"),"video.personalizedEffectsChanged",[e])}function uI(){return ic(rz),ui()}function uT(e,t=e6.Warn){a8(rH("v2","videoEffectsEx.notifyError"),"video.notifyError",[e,t])}function uP(e){if(ic(rz),!ui())throw rh;uT(e,e6.Fatal)}(Z=e6||(e6={})).Fatal="fatal",Z.Warn="warn";class uO extends oO{validate(e){return"ConfigurableTab"===e.tabType}deserialize(e){return e}}class uR{constructor(e){this.configurableTabInstance=e}serialize(){return this.configurableTabInstance}}class uF{constructor(e){this.hostEntityId=e}serialize(){return this.hostEntityId}}class uk extends oO{validate(e){return"ConfigurableTab"===e.tabType||"StaticTab"===e.tabType}deserialize(e){return e}}class uM{constructor(e){this.hostEntityTabInstance=e}serialize(){return this.hostEntityTabInstance}}class uN extends oO{validate(e){let t=new uk,n=!0;return e.allTabs&&e.allTabs.forEach(e=>{n||(n=t.validate(e))}),n}deserialize(e){return e}}function ux(e,t){if(ic(rz),!uH())throw Error(`Error code: ${nH.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);if(uV(e.threadId),t&&0===t.length)throw Error(`Error code: ${nH.INVALID_ARGUMENTS}, message: App types cannot be an empty array`);return a3("hostEntity.tab.addAndConfigure",[new uF(e),t],new uk,rH("v2","hostEntity.tab.addAndConfigure"))}function uD(e){if(ic(rz),!uH())throw Error(`Error code: ${nH.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return uV(e.threadId),a3("hostEntity.tab.getAll",[new uF(e)],new uN,rH("v2","hostEntity.tab.getAll"))}function uU(e,t){if(ic(rz),!uH())throw Error(`Error code: ${nH.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return uB(e),uV(t.threadId),a3("hostEntity.tab.reconfigure",[new uR(e),new uF(t)],new uO,rH("v2","hostEntity.tab.reconfigure"))}function uL(e,t){if(ic(rz),!uH())throw Error(`Error code: ${nH.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return uB(e),uV(t.threadId),a3("hostEntity.tab.rename",[new uR(e),new uF(t)],new uO,rH("v2","hostEntity.tab.rename"))}function u_(e,t){if(ic(rz),!uH())throw Error(`Error code: ${nH.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return uV(t.threadId),uB(e),a3("hostEntity.tab.remove",[new uM(e),new uF(t)],new oR,rH("v2","hostEntity.tab.remove"))}function uH(){var e;return!!(ic(rz)&&uj()&&(null==(e=rz.supports.hostEntity)?void 0:e.tab))}function uV(e){if(!e||0==e.length)throw Error(`Error code: ${nH.INVALID_ARGUMENTS}, message: ThreadId cannot be null or empty`)}function uB(e){if(!(null==e?void 0:e.internalTabInstanceId)||0===e.internalTabInstanceId.length)throw Error(`Error code: ${nH.INVALID_ARGUMENTS}, message: TabId cannot be null or empty`)}function uj(){return!(!ic(rz)||!rz.supports.hostEntity)}(X=e5||(e5={})).edu="EDU",X.baseTownhall="BASE_TOWNHALL",X.streamingTownhall="STREAMING_TOWNHALL";var uW=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};function uz(e){return uW(this,void 0,void 0,function*(){uK();let{size:t}=null!=e?e:{};return a6("store.openFullStore",[uQ(t)],rH("v2","store.openFullStore"))})}function uq(e){return uW(this,void 0,void 0,function*(){uK();let{size:t,appId:n}=e;if(!(n instanceof ih))throw Error("No App Id present, but AppId needed to open AppDetail store");return a6("store.openAppDetail",[uQ(t),n],rH("v2","store.openAppDetail"))})}function u$(e){return uW(this,void 0,void 0,function*(){uK();let{size:t,appCapability:n,appMetaCapabilities:r,installationScope:i,filteredOutAppIds:o}=null!=e?e:{};return a6("store.openInContextStore",[uQ(t),n,r,i,null==o?void 0:o.map(e=>e.toString())],rH("v2","store.openInContextStore"))})}function uG(e){return uW(this,void 0,void 0,function*(){uK();let{size:t,collectionId:n}=e;if(void 0===n)throw Error("No Collection Id present, but CollectionId needed to open a store specific to a collection");return a6("store.openSpecificStore",[uQ(t),n],rH("v2","store.openSpecificStore"))})}function uJ(){return ic(rz)&&!!rz.supports.store}function uK(){if(ic(rz,eI.content,eI.sidePanel,eI.meetingStage),!uJ())throw rh}function uQ(e){if(void 0===e)return;let{width:t,height:n}=e;if(void 0!==t&&"number"==typeof t&&t<0||void 0!==n&&"number"==typeof n&&n<0)throw Error("Invalid store dialog size");return JSON.stringify(e)}function uZ(e){d=e}function uX(e){let t=void 0!==e,n=t?e:d;if(!n)throw Error("No parameters are provided for authentication");return ic(rz,eI.content,eI.sidePanel,eI.settings,eI.remove,eI.task,eI.stage,eI.meetingStage),(function(e,t){var n,r,i,o;return n=this,r=void 0,i=void 0,o=function*(){let n=function(e){let t=document.createElement("a");return t.href=e,new URL(t.href)}(t.url);return rO(n),a1(e,"authentication.authenticate",[n.href,t.width,t.height,t.isExternal]).then(([e,t])=>{if(e)return t;throw Error(t)})},new(i||(i=Promise))(function(e,t){function a(e){try{l(o.next(e))}catch(e){t(e)}}function s(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):((n=t.value)instanceof i?n:new i(function(e){e(n)})).then(a,s)}l((o=o.apply(n,r||[])).next())})})(n.successCallback||n.failureCallback?rH("v1","authentication.authenticate"):rH("v2","authentication.authenticate"),n).then(e=>{try{return n&&n.successCallback?(n.successCallback(e),""):e}finally{t||(d=void 0)}}).catch(e=>{try{if(n&&n.failureCallback)return n.failureCallback(e.message),"";throw e}finally{t||(d=void 0)}})}function uY(e){var t,n;return iu(),(t=e&&(e.successCallback||e.failureCallback)?rH("v1","authentication.getAuthToken"):rH("v2","authentication.getAuthToken"),n=e,new Promise(e=>{e(a1(t,"authentication.getAuthToken",[null==n?void 0:n.resources,null==n?void 0:n.claims,null==n?void 0:n.silent,null==n?void 0:n.tenantId]))}).then(([e,t])=>{if(e)return t;throw Error(t)})).then(t=>e&&e.successCallback?(e.successCallback(t),""):t).catch(t=>{if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t})}function u0(e){var t;return iu(),(t=e&&(e.successCallback||e.failureCallback)?rH("v1","authentication.getUser"):rH("v2","authentication.getUser"),new Promise(e=>{e(a1(t,"authentication.getUser"))}).then(([e,t])=>{if(e)return t;throw t})).then(t=>e&&e.successCallback?(e.successCallback(t),null):t).catch(t=>{let n=`Error returned, code = ${t.errorCode}, message = ${t.message}`;if(e&&e.failureCallback)return e.failureCallback(n),null;throw Error(n)})}function u1(e,t){ic(rz,eI.authentication),a8(rH(t?"v1":"v2","authentication.notifySuccess"),"authentication.authenticate.success",[e]),sg(aK.parentWindow,()=>setTimeout(()=>aK.currentWindow.close(),200))}function u2(e,t){ic(rz,eI.authentication),a8(rH(t?"v1":"v2","authentication.notifyFailure"),"authentication.authenticate.failure",[e]),sg(aK.parentWindow,()=>setTimeout(()=>aK.currentWindow.close(),200))}function u3(e){let t=!e||e.length<=0,n=null==e?void 0:e.indexOf("@"),r=null==e?void 0:e.indexOf(".",n);if(t||-1===n||-1===r)throw Error("Input email address does not have the correct format.")}(Y=e8||(e8={})).Public="public",Y.EUDB="eudb",Y.Other="other";class u6{constructor(e){this.val=e,u3(e)}toString(){return this.val}}let u5="users";function u8(e,t,n){if(0===e.length)throw Error("Must have at least one user when creating a chat deep link");let r=`${u5}=`+e.map(e=>encodeURIComponent(e)).join(","),i=void 0===t?"":`&topicName=${encodeURIComponent(t)}`,o=void 0===n?"":`&message=${encodeURIComponent(n)}`;return`${n2}://${n3}/l/chat/0/0?${r}${i}${o}`}function u4(e){return new Promise(t=>{if(ic(rz,eI.content,eI.sidePanel,eI.settings,eI.task,eI.stage,eI.meetingStage),!u9())throw Error("Not supported");let n=rH("v1","appInstallDialog.openAppInstallDialog");rz.isLegacyTeams?t(aX(n,"executeDeepLink",function(e){if(!e)throw Error("App ID must be set when creating an app install dialog deep link");return`${n2}://${n3}/l/app/${encodeURIComponent(e)}`}(e.appId))):(a8(n,"appInstallDialog.openAppInstallDialog",[e]),t())})}function u9(){return!(!ic(rz)||!rz.supports.appInstallDialog)}let u7=r_("media");(ee=e4||(e4={})).Base64="base64",ee.ID="id";class ce{}function ct(e){if(!e)throw Error("[captureImage] Callback cannot be null");(ic(rz,eI.content,eI.task),rN.isFramelessWindow)?id("1.7.0")?a8(rH("v1","media.captureImage"),"captureImage",e):e({errorCode:nH.OLD_PLATFORM},[]):e({errorCode:nH.NOT_SUPPORTED_ON_PLATFORM},[])}function cn(){if(ic(rz,eI.content,eI.task),!ci())throw rh;let e=nV.Media;return new Promise(t=>{t(a0(rH("v1","media.hasPermission"),"permissions.has",e))})}function cr(){if(ic(rz,eI.content,eI.task),!ci())throw rh;let e=nV.Media;return new Promise(t=>{t(a0(rH("v1","media.requestPermission"),"permissions.request",e))})}function ci(){return!(!ic(rz)||!rz.supports.permissions)}class co extends ce{constructor(e){super(),e&&(this.content=e.content,this.format=e.format,this.mimeType=e.mimeType,this.name=e.name,this.preview=e.preview,this.size=e.size)}getMedia(e){var t,n,r;if(!e)throw Error("[get Media] Callback cannot be null");(ic(rz,eI.content,eI.task),id(nX))?(t=this.mimeType,n=this.format,r=this.content,null!=t&&null!=n&&n==e4.ID&&null!=r)?id("2.0.0")?this.getMediaViaCallback(e):this.getMediaViaHandler(e):e({errorCode:nH.INVALID_ARGUMENTS},new Blob):e({errorCode:nH.OLD_PLATFORM},new Blob)}getMediaViaCallback(e){let t={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[this.content];a8(rH("v1","media.getMedia"),"getMedia",n,function(n){if(e)if(n&&n.error)e(n.error,new Blob);else if(n&&n.mediaChunk)if(n.mediaChunk.chunkSequence<=0){let r=cd(t.assembleAttachment,t.mediaMimeType);e(n.error,null!=r?r:new Blob)}else{let e=cf(n.mediaChunk,t.mediaMimeType);e?t.assembleAttachment.push(e):u7(`Received a null assemble attachment for when decoding chunk sequence ${n.mediaChunk.chunkSequence}; not including the chunk in the assembled file.`)}else e({errorCode:nH.INTERNAL_ERROR,message:"data received is null"},new Blob)})}getMediaViaHandler(e){let t=rp(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},r=[t,this.content];this.content&&!iv(e)&&a8(rH("v1","media.getMedia"),"getMedia",r),aR(rH("v1","media.registerGetMediaRequestHandler"),"getMedia"+t,function(r){if(e){let i=JSON.parse(r);if(i.error)e(i.error,new Blob),aF("getMedia"+t);else if(i.mediaChunk)if(i.mediaChunk.chunkSequence<=0){let r=cd(n.assembleAttachment,n.mediaMimeType);e(i.error,null!=r?r:new Blob),aF("getMedia"+t)}else{let e=cf(i.mediaChunk,n.mediaMimeType);e&&n.assembleAttachment.push(e)}else e({errorCode:nH.INTERNAL_ERROR,message:"data received is null"},new Blob),aF("getMedia"+t)}})}}class ca{constructor(e){this.controllerCallback=e}notifyEventToHost(e,t){ic(rz,eI.content,eI.task);try{ip(nQ)}catch(e){return void(t&&t(e))}let n={mediaType:this.getMediaType(),mediaControllerEvent:e};a8(rH("v1","media.controller"),"media.controller",[n],e=>{t&&t(e)})}stop(e){this.notifyEventToHost(e9.StopRecording,e)}}class cs extends ca{getMediaType(){return tt.Video}notifyEventToApp(e){this.controllerCallback&&e===e9.StartRecording&&this.controllerCallback.onRecordingStarted&&this.controllerCallback.onRecordingStarted()}}function cl(e,t){var n,r,i,o,a,s;if(!t)throw Error("[select Media] Callback cannot be null");if(ic(rz,eI.content,eI.task),!id(nX))return void t({errorCode:nH.OLD_PLATFORM},[]);try{!(r=n=e)||r.mediaType!=tt.VideoAndImage&&!r.videoAndImageProps?!(i=n)||i.mediaType!=tt.Video||!i.videoProps||i.videoProps.isFullScreenMode?(o=n,(null==o?void 0:o.mediaType)!=tt.Image||!(null==(a=null==o?void 0:o.imageProps)?void 0:a.imageOutputFormats)||ip("2.0.4")):ip(nQ):ip("2.0.2")}catch(e){return void t(e,[])}if(null==(s=e)||s.maxMediaCount>10)return void t({errorCode:nH.INVALID_ARGUMENTS},[]);let l=[e];a8(rH("v1","media.selectMedia"),"selectMedia",l,(n,r,i)=>{var o,a,s;if(i){return void(!((s=e).mediaType!=tt.Video||!s.videoProps||!s.videoProps.videoController)&&(null==(a=null==(o=null==e?void 0:e.videoProps)?void 0:o.videoController)||a.notifyEventToApp(i)))}if(!r)return void t(n,[]);let l=[];for(let e of r)l.push(new co(e));t(n,l)})}function cu(e,t){var n;if(!t)throw Error("[view images] Callback cannot be null");if(ic(rz,eI.content,eI.task),!id(nX))return void t({errorCode:nH.OLD_PLATFORM});if(null==(n=e)||n.length<=0||n.length>10)return void t({errorCode:nH.INVALID_ARGUMENTS});let r=[e];a8(rH("v1","media.viewImages"),"viewImages",r,t)}function cc(e,t){if(!e)throw Error("[media.scanBarCode] Callback cannot be null");(ic(rz,eI.content,eI.task),rN.hostClientType!==eA.desktop&&rN.hostClientType!==eA.web&&rN.hostClientType!==eA.rigel&&rN.hostClientType!==eA.teamsRoomsWindows&&rN.hostClientType!==eA.teamsRoomsAndroid&&rN.hostClientType!==eA.teamsPhones&&rN.hostClientType!==eA.teamsDisplays)?id("1.9.0")?cp(t)?a8(rH("v1","media.scanBarCode"),"media.scanBarCode",[t],e):e({errorCode:nH.INVALID_ARGUMENTS},""):e({errorCode:nH.OLD_PLATFORM},""):e({errorCode:nH.NOT_SUPPORTED_ON_PLATFORM},"")}function cd(e,t){if(null==e||null==t||e.length<=0)return null;let n=null,r=1;return e.sort((e,t)=>e.sequence>t.sequence?1:-1),e.forEach(e=>{e.sequence==r&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),r++)}),n}function cf(e,t){if(null==e||null==t)return null;let n=atob(e.chunk),r=Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);let i=new Blob([new Uint8Array(r)],{type:t});return{sequence:e.chunkSequence,file:i}}function cp(e){return!e||!(null===e.timeOutIntervalInSec||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec<=0||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec>60)}function cg(e){return new Promise(t=>{if(ic(rz,eI.content,eI.task),!cv())throw rh;if(!cp(e))throw{errorCode:nH.INVALID_ARGUMENTS};t(a0(rH("v2","barCode.scanBarCode"),"media.scanBarCode",e))})}function cm(){if(ic(rz,eI.content,eI.task),!cv())throw rh;let e=nV.Media;return new Promise(t=>{t(a0(rH("v2","barCode.hasPermission"),"permissions.has",e))})}function ch(){if(ic(rz,eI.content,eI.task),!cv())throw rh;let e=nV.Media;return new Promise(t=>{t(a0(rH("v2","barCode.requestPermission"),"permissions.request",e))})}function cv(){return!!(ic(rz)&&rz.supports.barCode&&rz.supports.permissions)}function cw(e){return cy(rH("v2","chat.openChat"),e)}function cy(e,t){return new Promise(n=>{if(ic(rz,eI.content,eI.task),!cb())throw rh;n(rz.isLegacyTeams?aX(e,"executeDeepLink",u8([t.user],void 0,t.message)):aX(e,"chat.openChat",{members:[t.user],message:t.message}))})}function cC(e){let t=rH("v2","chat.openGroupChat");return new Promise(n=>{if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length)n(cy(t,{user:e.users[0],message:e.message}));else{if(ic(rz,eI.content,eI.task),!cb())throw rh;n(rz.isLegacyTeams?aX(t,"executeDeepLink",u8(e.users,e.topic,e.message)):aX(t,"chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}})}function cb(){return!(!ic(rz)||!rz.supports.chat)}(et=e9||(e9={}))[et.StartRecording=1]="StartRecording",et[et.StopRecording=2]="StopRecording",(en=e7||(e7={}))[en.Photo=1]="Photo",en[en.Document=2]="Document",en[en.Whiteboard=3]="Whiteboard",en[en.BusinessCard=4]="BusinessCard",(er=te||(te={}))[er.Camera=1]="Camera",er[er.Gallery=2]="Gallery",(ei=tt||(tt={}))[ei.Image=1]="Image",ei[ei.Video=2]="Video",ei[ei.VideoAndImage=3]="VideoAndImage",ei[ei.Audio=4]="Audio",(eo=tn||(tn={}))[eo.ID=1]="ID",eo[eo.URL=2]="URL",(ea=tr||(tr={}))[ea.IMAGE=1]="IMAGE",ea[ea.PDF=2]="PDF";var cS=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};function cA(e){return cS(this,void 0,void 0,function*(){if(ic(rz,eI.content,eI.meetingStage,eI.task,eI.settings,eI.stage,eI.sidePanel),!cI())throw rh;if(!e.type||!Object.values(nq).includes(e.type))throw Error(`Blob type ${e.type} is not supported. Supported blob types are ${Object.values(nq)}`);let t=yield new Promise((t,n)=>{0===e.size&&n(Error("Blob cannot be empty."));let r=new FileReader;r.onloadend=()=>{r.result?t(r.result.toString().split(",")[1]):n(Error("Failed to read the blob"))},r.onerror=()=>{n(r.error)},r.readAsDataURL(e)}),n={mimeType:e.type,content:t};return a0(rH("v2","clipboard.write"),"clipboard.writeToClipboard",n)})}function cE(){return cS(this,void 0,void 0,function*(){ic(rz,eI.content,eI.meetingStage,eI.task,eI.settings,eI.stage,eI.sidePanel);let e=rH("v2","clipboard.read");if(!cI())throw rh;let t=yield a0(e,"clipboard.readFromClipboard");if("string"==typeof t){var n,r;let e=JSON.parse(t);return n=e.mimeType,r=e.content,new Promise((e,t)=>{if(n||t("MimeType cannot be null or empty."),r||t("Base64 string cannot be null or empty."),n.startsWith("image/")){let t=atob(r),i=new Uint8Array(t.length);for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);e(new Blob([i],{type:n}))}e(new Blob([n8.from(r,"base64").toString()],{type:n}))})}return t})}function cI(){return rN.isFramelessWindow?!(!ic(rz)||!rz.supports.clipboard):!!(ic(rz)&&navigator&&navigator.clipboard&&rz.supports.clipboard)}var cT=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};let cP={validate:e=>Array.isArray(e)||"object"==typeof e,deserialize:e=>e};function cO(){var e;return null!=(e=ic(rz)&&(rz.isNAAChannelRecommended||!!(ic(rz)&&(rN.hostClientType===eA.android||rN.hostClientType===eA.ios||rN.hostClientType===eA.ipados||rN.hostClientType===eA.visionOS)&&rz.isLegacyTeams&&rz.supports.nestedAppAuth)))&&e}function cR(){return ic(rz),aK.parentOrigin}function cF(){var e;return null!=(e=ic(rz)&&rz.canParentManageNAATrustedOrigins)&&e}function ck(){var e;return null!=(e=ic(rz)&&rz.isDeeplyNestedAuthSupported)&&e}function cM(e){return cT(this,void 0,void 0,function*(){if(!cF())throw rh;let t=e.map(cD);return cx(ti.ADD,t)})}function cN(e){return cT(this,void 0,void 0,function*(){if(!cF())throw rh;let t=e.map(cD);return cx(ti.DELETE,t)})}function cx(e,t){return cT(this,void 0,void 0,function*(){if(window.parent!==window.top)throw Error("This API is only available in the top-level parent.");if(!Array.isArray(t)||0===t.length)throw Error(`The '${t}' parameter is required and must be a non-empty array.`);return a3("nestedAppAuth.manageNAATrustedOrigins",[new cU(e,t)],cP,rH("v2","nestedAppAuth.manageNAATrustedOrigins"))})}function cD(e){try{return new URL(e).origin.toLowerCase()}catch(t){throw Error(`Invalid origin provided: ${e}`)}}(es=ti||(ti={})).ADD="ADD",es.DELETE="DELETE";class cU{constructor(e,t){this.action=e,this.appOrigins=t}serialize(){return{action:this.action,appOrigins:this.appOrigins}}}function cL(){if(ic(rz,eI.content,eI.task),!cH())throw rh;return a0(rH("v2","geoLocation.map.chooseLocation"),"location.getLocation",{allowChooseLocation:!0,showMap:!0})}function c_(e){if(ic(rz,eI.content,eI.task),!cH())throw rh;if(!e)throw{errorCode:nH.INVALID_ARGUMENTS};return a0(rH("v2","geoLocation.showLocation"),"location.showLocation",e)}function cH(){return!!(ic(rz)&&rz.supports.geoLocation&&rz.supports.geoLocation.map&&rz.supports.permissions)}function cV(){if(ic(rz,eI.content,eI.task),!cW())throw rh;return a0(rH("v2","geoLocation.getCurrentLocation"),"location.getLocation",{allowChooseLocation:!1,showMap:!1})}function cB(){if(ic(rz,eI.content,eI.task),!cW())throw rh;let e=nV.GeoLocation;return new Promise(t=>{t(a0(rH("v2","geoLocation.hasPermission"),"permissions.has",e))})}function cj(){if(ic(rz,eI.content,eI.task),!cW())throw rh;let e=nV.GeoLocation;return new Promise(t=>{t(a0(rH("v2","geoLocation.requestPermission"),"permissions.request",e))})}function cW(){return!!(ic(rz)&&rz.supports.geoLocation&&rz.supports.permissions)}function cz(){return rz.hostVersionsInfo?rz.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}class cq{postMessage(e,t){ic(rz),a8(rH("v1","appWindow.childAppWindow.postMessage"),"messageForChild",[e],t||rC())}addEventListener(e,t){ic(rz),"message"===e&&aR(rH("v1","appWindow.childAppWindow.addEventListener"),"messageForParent",t)}}class c${static get Instance(){return this._instance||(this._instance=new this)}postMessage(e,t){ic(rz,eI.task),a8(rH("v1","appWindow.parentAppWindow.postMessage"),"messageForParent",[e],t||rC())}addEventListener(e,t){ic(rz,eI.task),"message"===e&&aR(rH("v1","appWindow.parentAppWindow.addEventListener"),"messageForChild",t)}}function cG(e){if(ic(rz,eI.content),!cJ())throw rh;if(!e||!rE(e))throw{errorCode:nH.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return a0(rH("v2","secondaryBrowser.openUrl"),"secondaryBrowser.open",e.toString())}function cJ(){return!(!ic(rz)||!rz.supports.secondaryBrowser)}function cK(e,t){if(!t)throw Error("[location.getLocation] Callback cannot be null");if(ic(rz,eI.content,eI.task),!id(nZ))throw{errorCode:nH.OLD_PLATFORM};if(!e)throw{errorCode:nH.INVALID_ARGUMENTS};if(!cZ())throw rh;a8(rH("v1","location.getLocation"),"location.getLocation",[e],t)}function cQ(e,t){if(!t)throw Error("[location.showLocation] Callback cannot be null");if(ic(rz,eI.content,eI.task),!id(nZ))throw{errorCode:nH.OLD_PLATFORM};if(!e)throw{errorCode:nH.INVALID_ARGUMENTS};if(!cZ())throw rh;a8(rH("v1","location.showLocation"),"location.showLocation",[e],t)}function cZ(){return!(!ic(rz)||!rz.supports.location)}function cX(e){ic(rz,eI.sidePanel),e.contentUrl&&new URL(e.contentUrl),a8(rH("v1","meeting.appShareButton.setOptions"),"meeting.appShareButton.setOptions",[e])}var cY=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};function c0(e){if(!e)throw Error("[get incoming client audio state] Callback cannot be null");ic(rz,eI.sidePanel,eI.meetingStage),a8(rH("v1","meeting.getIncomingClientAudioState"),"getIncomingClientAudioState",e)}function c1(e){if(!e)throw Error("[toggle incoming client audio] Callback cannot be null");ic(rz,eI.sidePanel,eI.meetingStage),a8(rH("v1","meeting.toggleIncomingClientAudio"),"toggleIncomingClientAudio",e)}function c2(e){if(!e)throw Error("[get meeting details] Callback cannot be null");ic(rz,eI.sidePanel,eI.meetingStage,eI.settings,eI.content),a8(rH("v1","meeting.getMeetingDetails"),"meeting.getMeetingDetails",e)}function c3(){var e,t,n;return cY(this,void 0,void 0,function*(){let r;ic(rz,eI.sidePanel,eI.meetingStage,eI.settings,eI.content);try{r=yield a0(rH("v2","meeting.getMeetingDetailsVerbose"),"meeting.getMeetingDetails",!0)}catch(t){throw Error(null==(e=null==t?void 0:t.errorCode)?void 0:e.toString())}if(((null==(t=r.details)?void 0:t.type)==tl.GroupCall||(null==(n=r.details)?void 0:n.type)==tl.OneOnOneCall)&&!r.details.originalCallerInfo)throw Error(nH.NOT_SUPPORTED_ON_PLATFORM.toString());return r})}function c6(e){if(!e)throw Error("[get Authentication Token For AnonymousUser] Callback cannot be null");ic(rz,eI.sidePanel,eI.meetingStage,eI.task),a8(rH("v1","meeting.getAuthenticationTokenForAnonymousUser"),"meeting.getAuthenticationTokenForAnonymousUser",e)}function c5(e){if(!e)throw Error("[get live stream state] Callback cannot be null");ic(rz,eI.sidePanel),a8(rH("v1","meeting.getLiveStreamState"),"meeting.getLiveStreamState",e)}function c8(e,t,n){if(!e)throw Error("[request start live streaming] Callback cannot be null");ic(rz,eI.sidePanel),a8(rH("v1","meeting.requestStartLiveStreaming"),"meeting.requestStartLiveStreaming",[t,n],e)}function c4(e){if(!e)throw Error("[request stop live streaming] Callback cannot be null");ic(rz,eI.sidePanel),a8(rH("v1","meeting.requestStopLiveStreaming"),"meeting.requestStopLiveStreaming",e)}function c9(e){if(!e)throw Error("[register live stream changed handler] Handler cannot be null");ic(rz,eI.sidePanel),aR(rH("v1","meeting.registerLiveStreamChangedHandler"),"meeting.liveStreamChanged",e)}function c7(e,t,n={sharingProtocol:tu.Collaborative}){if(!e)throw Error("[share app content to stage] Callback cannot be null");ic(rz,eI.sidePanel,eI.meetingStage),a8(rH("v1","meeting.shareAppContentToStage"),"meeting.shareAppContentToStage",[t,n],e)}function de(e){if(!e)throw Error("[get app content stage sharing capabilities] Callback cannot be null");ic(rz,eI.sidePanel,eI.meetingStage),a8(rH("v1","meeting.getAppContentStageSharingCapabilities"),"meeting.getAppContentStageSharingCapabilities",e)}function dt(e){if(!e)throw Error("[stop sharing app content to stage] Callback cannot be null");ic(rz,eI.sidePanel,eI.meetingStage),a8(rH("v1","meeting.stopSharingAppContentToStage"),"meeting.stopSharingAppContentToStage",e)}function dn(e){if(!e)throw Error("[get app content stage sharing state] Callback cannot be null");ic(rz,eI.sidePanel,eI.meetingStage),a8(rH("v1","meeting.getAppContentStageSharingState"),"meeting.getAppContentStageSharingState",e)}function dr(e){if(!e)throw Error("[registerSpeakingStateChangeHandler] Handler cannot be null");ic(rz,eI.sidePanel,eI.meetingStage),aR(rH("v1","meeting.registerSpeakingStateChangeHandler"),"meeting.speakingStateChanged",e)}function di(e){if(!e)throw Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");ic(rz,eI.sidePanel,eI.meetingStage),aR(rH("v1","meeting.registerRaiseHandStateChangedHandler"),"meeting.raiseHandStateChanged",e)}function da(e){if(!e)throw Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");ic(rz,eI.sidePanel,eI.meetingStage),aR(rH("v1","meeting.registerMeetingReactionReceivedHandler"),"meeting.meetingReactionReceived",e)}function ds(e){if(void 0===(null==e?void 0:e.joinWebUrl)||null===(null==e?void 0:e.joinWebUrl))return Promise.reject(Error("Invalid joinMeetingParams"));ic(rz);let t={joinWebUrl:e.joinWebUrl.href,source:e.source||tc.Other};return a0(rH("v2","meeting.joinMeeting"),"meeting.joinMeeting",t)}function dl(e,t){var n,r;if(!t)throw Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");ic(rz,eI.sidePanel,eI.meetingStage),e.isAppHandlingAudio?function(e,t){a8(rH("v1","meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],(n,r)=>{if(n&&null!=r)throw Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(n)throw Error(`[requestAppAudioHandling] Callback response - SDK error ${n.errorCode} ${n.message}`);if("boolean"!=typeof r)throw Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");aR(rH("v1","meeting.registerMicStateChangeHandler"),"meeting.micStateChanged",t=>cY(this,void 0,void 0,function*(){try{let n=yield e.micMuteStateChangedCallback(t);dc(n,n.isMicMuted===t.isMicMuted?to.HostInitiated:to.AppDeclinedToChange)}catch(e){dc(t,to.AppFailedToChange)}})),aR(rH("v1","meeting.registerAudioDeviceSelectionChangedHandler"),"meeting.audioDeviceSelectionChanged",t=>{var n;null==(n=e.audioDeviceSelectionChangedCallback)||n.call(e,t)}),t(r)})}(e,t):(n=e,r=t,a8(rH("v1","meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[n.isAppHandlingAudio],(e,t)=>{if(e&&null!=t)throw Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(e)throw Error(`[requestAppAudioHandling] Callback response - SDK error ${e.errorCode} ${e.message}`);if("boolean"!=typeof t)throw Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");ak("meeting.micStateChanged")&&aF("meeting.micStateChanged"),ak("meeting.audioDeviceSelectionChanged")&&aF("meeting.audioDeviceSelectionChanged"),r(t)}))}function du(e){dc(e,to.AppInitiated)}function dc(e,t){ic(rz,eI.sidePanel,eI.meetingStage),a8(rH("v1","meeting.setMicStateWithReason"),"meeting.updateMicState",[e,t])}function dd(e,t){let n,r,i="";return"function"==typeof e?(n=e,r=t,i=rH("v1","monetization.openPurchaseExperience")):(r=e,i=rH("v2","monetization.openPurchaseExperience")),ic(rz,eI.content),function(e,t,...n){let r=e(...n);return r.then(e=>{t&&t(null,e)}).catch(e=>{t&&t(e,null)}),r}(()=>new Promise(e=>{if(!df())throw rh;e(a0(i,"monetization.openPurchaseExperience",r))}),n)}function df(){return!(!ic(rz)||!rz.supports.monetization)}function dp(e){return new Promise(t=>{if(ic(rz,eI.content),!dm())throw Error("Not supported");if(!e.itemId||!e.itemId.trim())throw Error("Must supply an itemId to openCalendarItem");t(aX(rH("v2","calendar.openCalendarItem"),"calendar.openCalendarItem",e))})}function dg(e){return new Promise(t=>{if(ic(rz,eI.content),!dm())throw Error("Not supported");let n=rH("v2","calendar.composeMeeting");t(rz.isLegacyTeams?aX(n,"executeDeepLink",function(e,t,n,r,i){let o=void 0===e?"":"attendees="+e.map(e=>encodeURIComponent(e)).join(","),a=void 0===t?"":`&startTime=${encodeURIComponent(t)}`,s=void 0===n?"":`&endTime=${encodeURIComponent(n)}`,l=void 0===r?"":`&subject=${encodeURIComponent(r)}`,u=void 0===i?"":`&content=${encodeURIComponent(i)}`;return`${n2}://${n3}/l/meeting/new?${o}${a}${s}${l}${u}`}(e.attendees,e.startTime,e.endTime,e.subject,e.content)):aX(n,"calendar.composeMeeting",e))})}function dm(){return!(!ic(rz)||!rz.supports.calendar)}function dh(e){e&&0!==e.length&&e.forEach(e=>{u3(e)})}function dv(e){if(ic(rz,eI.content),!dw())throw Error("Not supported");return function(e){if(!e.handoffId||0==e.handoffId.trim().length||""===e.handoffId.trim())throw Error("handoffId should not be null or empty string.");let t=e.composeMailParams;t.type===td.New&&(dh(t.toRecipients),dh(t.ccRecipients),dh(t.bccRecipients))}(e),a6("mail.handoff.composeMail",[new dy(e)],rH("v2","mail.handoff.composeMail"))}function dw(){return!!(ic(rz)&&rz.supports.mail&&rz.supports.mail.handoff)}(el=to||(to={}))[el.HostInitiated=0]="HostInitiated",el[el.AppInitiated=1]="AppInitiated",el[el.AppDeclinedToChange=2]="AppDeclinedToChange",el[el.AppFailedToChange=3]="AppFailedToChange",(eu=ta||(ta={})).like="like",eu.heart="heart",eu.laugh="laugh",eu.surprised="surprised",eu.applause="applause",(ec=ts||(ts={})).Unknown="Unknown",ec.Adhoc="Adhoc",ec.Scheduled="Scheduled",ec.Recurring="Recurring",ec.Broadcast="Broadcast",ec.MeetNow="MeetNow",(ed=tl||(tl={})).OneOnOneCall="oneOnOneCall",ed.GroupCall="groupCall",(ef=tu||(tu={})).Collaborative="Collaborative",ef.ScreenShare="ScreenShare",(ep=tc||(tc={})).M365CalendarGridContextMenu="m365_calendar_grid_context_menu",ep.M365CalendarGridPeek="m365_calendar_grid_peek",ep.M365CalendarGridEventCardJoinButton="m365_calendar_grid_event_card_join_button",ep.M365CalendarFormRibbonJoinButton="m365_calendar_form_ribbon_join_button",ep.M365CalendarFormJoinTeamsMeetingButton="m365_calendar_form_join_teams_meeting_button",ep.Other="other";class dy{constructor(e){this.composeMailParamsWithHandoff=e}serialize(){return this.composeMailParamsWithHandoff}}function dC(e){return new Promise(t=>{if(ic(rz,eI.content),!dS())throw Error("Not supported");if(!e.itemId||!e.itemId.trim())throw Error("Must supply an itemId to openMailItem");t(aX(rH("v2","mail.openMailItem"),"mail.openMailItem",e))})}function db(e){return new Promise(t=>{if(ic(rz,eI.content),!dS())throw Error("Not supported");t(aX(rH("v2","mail.composeMail"),"mail.composeMail",e))})}function dS(){return!(!ic(rz)||!rz.supports.mail)}function dA(){if(!rN.printCapabilityEnabled){if(ic(rz),!dR())throw rh;rN.printCapabilityEnabled=!0,document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(dE(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())})}}function dE(){rI().print()}function dI(e){dT(rH("v2","teamsAPIs_registerOnLoadHandler"),e,()=>{if(!iv(e)&&!dR())throw rh})}function dT(e,t,n){iv(t)||ic(rz),!iv(t)&&n&&n(),aT.loadHandler=t,iv(t)||a8(e,"registerHandler",["load"])}function dP(e){dO(rH("v2","teamsAPIs_registerBeforeUnloadHandler"),e,()=>{if(!iv(e)&&!dR())throw rh})}function dO(e,t,n){iv(t)||ic(rz),!iv(t)&&n&&n(),aT.beforeUnloadHandler=t,iv(t)||a8(e,"registerHandler",["beforeUnload"])}function dR(){return!(!ic(rz)||!rz.supports.teamsCore)}function dF(e,t){let n,r;ic(rz,eI.content,eI.task,eI.settings);let i="";return"function"==typeof e?([n,r]=[e,t],i=rH("v1","people.selectPeople")):(r=e,i=rH("v2","people.selectPeople")),function(e,t,...n){let r=e(...n);return r.then(e=>{t&&t(void 0,e)}).catch(e=>{t&&t(e)}),r}(dk,n,i,r)}function dk(e,t){return new Promise(n=>{var r;if(!id("2.0.0"))throw{errorCode:nH.OLD_PLATFORM};if(!((!(r=t)||(!r.title||"string"==typeof r.title)&&(!r.setSelected||"object"==typeof r.setSelected)&&(!r.openOrgWideSearchInChatOrChannel||"boolean"==typeof r.openOrgWideSearchInChatOrChannel)&&(!r.singleSelect||"boolean"==typeof r.singleSelect))&&1))throw{errorCode:nH.INVALID_ARGUMENTS};if(!dM())throw rh;n(a0(e,"people.selectPeople",t))})}function dM(){return!(!ic(rz)||!rz.supports.people)}function dN(e){return ic(rz,eI.content),new Promise(t=>{var n;let[r,i]=e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?(n=e.persona)?n.displayName&&"string"!=typeof n.displayName?[!1,"displayName must be a string"]:n.identifiers&&"object"==typeof n.identifiers?n.identifiers.AadObjectId||n.identifiers.Smtp||n.identifiers.Upn?n.identifiers.AadObjectId&&"string"!=typeof n.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:n.identifiers.Smtp&&"string"!=typeof n.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:n.identifiers.Upn&&"string"!=typeof n.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]:[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"];if(!r)throw{errorCode:nH.INVALID_ARGUMENTS,message:i};let o={modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}};t(a0(rH("v2","profile.showProfile"),"profile.showProfile",o))})}function dx(){return!(!ic(rz)||!rz.supports.profile)}(eg=td||(td={})).New="new",eg.Reply="reply",eg.ReplyAll="replyAll",eg.Forward="forward";let dD="search.queryChange",dU="search.queryClose",dL="search.queryExecute";function d_(e,t,n){if(ic(rz,eI.content),!dV())throw rh;aR(rH("v2","search.registerOnClosedHandler"),dU,e),aR(rH("v2","search.registerOnExecutedHandler"),dL,t),n&&aR(rH("v2","search.registerOnChangeHandler"),dD,n)}function dH(){if(ic(rz,eI.content),!dV())throw rh;a8(rH("v2","search.unregisterHandlers"),"search.unregister"),aF(dD),aF(dU),aF(dL)}function dV(){return!(!ic(rz)||!rz.supports.search)}function dB(){return new Promise(e=>{if(ic(rz,eI.content),!dV())throw Error("Not supported");e(aX(rH("v2","search.closeSearch"),"search.closeSearch"))})}function dj(){var e,t,n,r;return e=this,t=void 0,n=void 0,r=function*(){if(ic(rz,eI.sidePanel,eI.meetingStage),!dW())throw rh;return yield a0(rH("v2","sharing.history.getContent"),"sharing.history.getContent")},new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})}function dW(){var e;return ic(rz)&&void 0!==(null==(e=rz.supports.sharing)?void 0:e.history)}let dz={shareWebContent:"sharing.shareWebContent"};function dq(e,t){try{(function(e){if(!(e&&e.content&&e.content.length))throw{errorCode:nH.INVALID_ARGUMENTS,message:"Shared content is missing"}})(e),function(e){if(e.content.some(e=>!e.type))throw{errorCode:nH.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(e.content.some(t=>t.type!==e.content[0].type))throw{errorCode:nH.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}(e),function(e){if("URL"!==e.content[0].type)throw{errorCode:nH.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(e.content.some(e=>!e.url))throw{errorCode:nH.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}(e)}catch(e){return rS(()=>Promise.reject(e),t)}return ic(rz,eI.content,eI.sidePanel,eI.task,eI.stage,eI.meetingStage),rS(d$,t,rH(t?"v1":"v2","sharing.shareWebContent"),e)}function d$(e,t){return new Promise(n=>{if(!dG())throw rh;n(a0(e,dz.shareWebContent,t))})}function dG(){return!(!ic(rz)||!rz.supports.sharing)}function dJ(){return new Promise(e=>{if(ic(rz,eI.content),!dK())throw rh;e(a0(rH("v2","stageView.self.close"),"stageView.self.close"))})}function dK(){var e;return ic(rz)&&void 0!==(null==(e=rz.supports.stageView)?void 0:e.self)}function dQ(e){return new Promise(t=>{if(ic(rz,eI.content),!dZ())throw rh;if(!e)throw Error("[stageView.open] Stage view params cannot be null");t(a0(rH("v2","stageView.open"),"stageView.open",e))})}function dZ(){return!(!ic(rz)||!rz.supports.stageView)}(em=tf||(tf={})).modal="modal",em.popout="popout",em.popoutWithChat="popoutWithChat";var dX=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};function dY(e){return dX(this,void 0,void 0,function*(){ic(rz,eI.content,eI.task),d2(),d3(e);let t=yield a0(rH("v2","visualMedia.image.captureImages"),"visualMedia.image.captureImages",e);return d6(e.maxVisualMediaCount,t),t})}function d0(e){return dX(this,void 0,void 0,function*(){ic(rz,eI.content,eI.task),d2(),d3(e);let t=yield a0(rH("v2","visualMedia.image.retrieveImages"),"visualMedia.image.retrieveImages",e);return d6(e.maxVisualMediaCount,t),t})}function d1(){return!!(ic(rz)&&rz.supports.visualMedia&&rz.supports.visualMedia.image&&rz.supports.permissions)}function d2(){if(!d1())throw rh}function d3(e){if(!e||e.maxVisualMediaCount>10||e.maxVisualMediaCount<1)throw rw}function d6(e,t){if(t.length>e)throw ry}function d5(){if(ic(rz,eI.content,eI.task),!d1())throw rh;let e=nV.Media;return a0(rH("v2","visualMedia.hasPermission"),"permissions.has",e)}function d8(){if(ic(rz,eI.content,eI.task),!d1())throw rh;let e=nV.Media;return a0(rH("v2","visualMedia.requestPermission"),"permissions.request",e)}(eh=tp||(tp={}))[eh.FrontOrRear=1]="FrontOrRear",eh[eh.FrontOnly=2]="FrontOnly",eh[eh.RearOnly=3]="RearOnly",(ev=tg||(tg={}))[ev.Camera=1]="Camera",ev[ev.Gallery=2]="Gallery";let d4=null;var d9=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})};function d7(){return d9(this,void 0,void 0,function*(){if(ic(rz),!fe())throw rh;return!(!rz.isLegacyTeams||rN.hostClientType!==eA.android&&rN.hostClientType!==eA.ios&&rN.hostClientType!==eA.ipados&&rN.hostClientType!==eA.visionOS||(yield function(){return d9(this,void 0,void 0,function*(){return function(){var e,t,n,r;return e=this,t=void 0,n=void 0,r=function*(){return null===d4&&(d4=(yield iD()).app.host.name),d4},new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})}()})}())!==eE.teams)||(yield aZ(rH("v2","webStorage.isWebStorageClearedOnUserLogOut"),"webStorage.isWebStorageClearedOnUserLogOut"))})}function fe(){return ic(rz)&&void 0!==rz.supports.webStorage}function ft(e){let t=rH("v2","call.startCall");return new Promise(n=>{var r;if(ic(rz,eI.content,eI.task),!fn())throw rh;if(!rz.isLegacyTeams)return a8(t,"call.startCall",[e],n);n(aZ(t,"executeDeepLink",function(e,t,n){if(0===e.length)throw Error("Must have at least one target when creating a call deep link");let r=`${u5}=`+e.map(e=>encodeURIComponent(e)).join(","),i=void 0===t?"":`&withVideo=${encodeURIComponent(t)}`,o=void 0===n?"":`&source=${encodeURIComponent(n)}`;return`${n2}://${n3}/l/call/0/0?${r}${i}${o}`}(e.targets,null==(r=e.requestedModalities)?void 0:r.includes(tm.Video),e.source)).then(e=>{if(!e)throw Error("The call was not properly started");return e}))})}function fn(){return!(!ic(rz)||!rz.supports.call)}function fr(){oN(rH("v1","appInitialization.notifyAppLoaded"))}function fi(){a8(rH("v1","appInitialization.notifySuccess"),iR.Success,[rY])}function fo(e){oD(rH("v1","appInitialization.notifyFailure"),e)}function fa(e){ox(rH("v1","appInitialization.notifyExpectedFailure"),e)}(ew=tm||(tm={})).Unknown="unknown",ew.Audio="audio",ew.Video="video",ew.VideoBasedScreenSharing="videoBasedScreenSharing",ew.Data="data";let fs=r_("thirdPartyCloudStorage");class fl{constructor(e,t){this.fileType=e,this.assembleAttachment=t}}let fu=[],fc=null,fd=!0,ff=null;function fp(e,t){if(!t)throw Error("[getDragAndDropFiles] Callback cannot be null");if(e&&""!==e){if(ic(rz,eI.content,eI.task),!fm())throw rh;if(ff)throw ff=null,Error("getDragAndDropFiles cannot be called twice");ff=t,fd=!0,a8(rH("v2","thirdPartyCloudStorage.getDragAndDropFiles"),"thirdPartyCloudStorage.getDragAndDropFiles",[e],fg)}else t([],{errorCode:nH.INVALID_ARGUMENTS})}function fg(e){if(ff)if(e&&e.error)ff([],e.error),ff=null;else if(e&&e.fileChunk)try{fd||0!==e.fileChunk.chunkSequence||(fs("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),fd=!0,ff([],{errorCode:nH.INTERNAL_ERROR,message:"error occurred while receiving data"}),fu=[],ff=null);let t=cf(e.fileChunk,e.fileType);if(t?(fc||(fc=new fl(e.fileType,[])),fc.assembleAttachment.push(t)):(fs(`Received a null assemble attachment for when decoding chunk sequence ${e.fileChunk.chunkSequence}; not including the chunk in the assembled file.`),ff?ff([],{errorCode:nH.INTERNAL_ERROR,message:"error occurred while receiving data"}):ff=null,fu=[],ff=null,fd=!0),fd=e.fileChunk.endOfFile,e.fileChunk.endOfFile&&fc){let t=cd(fc.assembleAttachment,fc.fileType);if(t){let n=new File([t],e.fileName,{type:t.type});fu.push(n)}e.isLastFile&&ff&&(ff(fu,e.error),fu=[],ff=null,fd=!0),fc=null}}catch(e){ff&&(ff([],{errorCode:nH.INTERNAL_ERROR,message:e}),fu=[],ff=null,fd=!0)}else ff([],{errorCode:nH.INTERNAL_ERROR,message:"data received is null"}),fu=[],ff=null,fd=!0}function fm(){return!(!ic(rz)||!rz.supports.thirdPartyCloudStorage)}function fh(e,t){oM(rH("v1","initialize"),t).then(()=>{e&&e()})}function fv(){dA()}function fw(){dE()}function fy(e){iu(),a8(rH("v1","getContext"),"getContext",t=>{t.frameContext||(t.frameContext=rN.frameContext),e(t)})}function fC(e){o_(rH("v1","registerOnThemeChangeHandlerHelper"),e)}function fb(e){aM(rH("v1","registerFullScreenHandler"),"fullScreenChange",e,[])}function fS(e){aM(rH("v1","registerAppButtonClickHandler"),"appButtonClick",e,[eI.content])}function fA(e){aM(rH("v1","registerAppButtonHoverEnterHandler"),"appButtonHoverEnter",e,[eI.content])}function fE(e){aM(rH("v1","registerAppButtonHoverLeaveHandler"),"appButtonHoverLeave",e,[eI.content])}function fI(e){oY(rH("v1","registerBackButtonHandler"),e)}function fT(e){dT(rH("v1","registerOnLoadHandler"),e)}function fP(e){dO(rH("v1","registerBeforeUnloadHandler"),e)}function fO(e){aM(rH("v1","registerFocusEnterHandler"),"focusEnter",e,[])}function fR(e){aM(rH("v1","registerChangeSettingsHandler"),"changeSettings",e,[eI.content])}function fF(e,t){ic(rz),am(rH("v1","getTabInstances"),t).then(t=>{e(t)})}function fk(e,t){ic(rz),ah(rH("v1","getMruTabInstances"),t).then(t=>{e(t)})}function fM(e){av(rH("v1","shareDeepLink"),{subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function fN(e,t){ic(rz,eI.content,eI.sidePanel,eI.settings,eI.task,eI.stage,eI.meetingStage);let n=null!=t?t:rC();oH(rH("v1","executeDeepLink"),e).then(()=>{n(!0)}).catch(e=>{n(!1,e.message)})}function fx(e){aw(rH("v1","setFrameContext"),e)}function fD(e,t,n){oM(rH("v1","initializeWithFrameContext"),n).then(()=>t&&t()),aw(rH("v1","setFrameContext"),e)}function fU(e){var t=rH("v1","navigation.returnFocus");if(ic(rz),!ac())throw rh;a8(t,"returnFocus",[e])}function fL(e,t){ic(rz);let n=null!=t?t:rC();ag(rH("v1","navigation.navigateToTab"),e).then(()=>{n(!0)}).catch(e=>{n(!1,e.message)})}function f_(e,t){ic(rz,eI.content,eI.sidePanel,eI.settings,eI.remove,eI.task,eI.stage,eI.meetingStage);let n=null!=t?t:rC();af(rH("v1","navigation.navigateCrossDomain"),e).then(()=>{n(!0)}).catch(e=>{n(!1,e.message)})}function fH(e){ic(rz);let t=null!=e?e:rC();ap(rH("v1","navigation.navigateBack")).then(()=>{t(!0)}).catch(e=>{t(!1,e.message)})}function fV(e){ay(rH("v1","settings.setValidityState"),e)}function fB(e){ic(rz,eI.content,eI.settings,eI.remove,eI.sidePanel),aC(rH("v1","settings.getSettings")).then(t=>{e(t)})}function fj(e,t){ic(rz,eI.content,eI.settings,eI.sidePanel);let n=null!=t?t:rC();ab(rH("v1","settings.setSettings"),e).then(()=>{n(!0)}).catch(e=>{n(!1,e.message)})}function fW(e){oy(rH("v1","settings.registerOnSaveHandler"),e)}function fz(e){ob(rH("v1","settings.registerOnRemoveHandler"),e)}var fq=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function f$(e,t){let n=rH("v1","tasks.startTask"),r=t?e=>{var n,r;return t(null!=(n=e.err)?n:"",null!=(r=e.result)?r:"")}:void 0;return void 0===e.card&&void 0===e.url||e.card?(ic(rz,eI.content,eI.sidePanel,eI.meetingStage),a8(n,"tasks.startTask",[e],t)):void 0!==e.completionBotId?i5(n,function(e){if(void 0===e.url||void 0===e.completionBotId)throw Error(`Both url ${e.url} and completionBotId ${e.completionBotId} are required for bot url dialog. At least one is undefined.`);return{url:e.url,size:{height:e.height?e.height:eO.Small,width:e.width?e.width:eO.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}(e),r):i6(n,function(e){if(void 0===e.url)throw Error("url property of taskInfo object can't be undefined");return{url:e.url,size:{height:e.height?e.height:eO.Small,width:e.width?e.width:eO.Small},title:e.title,fallbackUrl:e.fallbackUrl}}(e),r),new cq}function fG(e){let{width:t,height:n}=e=fK(e);if(Object.keys(fq(e,["width","height"])).length)throw Error("resize requires a TaskInfo argument containing only width and height");i3(rH("v1","tasks.updateTask"),e)}function fJ(e,t){i8(rH("v1","tasks.submitTask"),e,t)}function fK(e){return e.height=e.height?e.height:eO.Small,e.width=e.width?e.width:eO.Small,e}function fQ(){return!(!ic(rz,eI.meetingStage,eI.sidePanel,eI.content)||!rz.supports.interactive)}(ey=th||(th={})).guest="Guest",ey.attendee="Attendee",ey.presenter="Presenter",ey.organizer="Organizer",(eC=tv||(tv={})).added="Added",eC.alreadyExists="AlreadyExists",eC.conflict="Conflict",eC.notFound="NotFound";class fZ{getFluidTenantInfo(){return fX(),new Promise(e=>{e(a0(rH("v2","interactive.getFluidTenantInfo"),"interactive.getFluidTenantInfo"))})}getFluidToken(e){return fX(),new Promise(t=>{t(a0(rH("v2","interactive.getFluidToken"),"interactive.getFluidToken",e))})}getFluidContainerId(){return fX(),new Promise(e=>{e(a0(rH("v2","interactive.getFluidContainerId"),"interactive.getFluidContainerId"))})}setFluidContainerId(e){return fX(),new Promise(t=>{t(a0(rH("v2","interactive.setFluidContainerId"),"interactive.setFluidContainerId",e))})}getNtpTime(){return fX(),new Promise(e=>{e(a0(rH("v2","interactive.getNtpTime"),"interactive.getNtpTime"))})}registerClientId(e){return fX(),new Promise(t=>{t(a0(rH("v2","interactive.registerClientId"),"interactive.registerClientId",e))})}getClientRoles(e){return fX(),new Promise(t=>{t(a0(rH("v2","interactive.getClientRoles"),"interactive.getClientRoles",e))})}getClientInfo(e){return fX(),new Promise(t=>{t(a0(rH("v2","interactive.getClientInfo"),"interactive.getClientInfo",e))})}static create(){return fX(),new fZ}}function fX(){if(!fQ())throw Error("LiveShareHost Not supported")}var fY=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function f0(e){try{return e.cartItems=function e(t){return t.map(t=>{if(t.imageURL){let e=new URL(t.imageURL);t.imageURL=e}return t.accessories&&(t.accessories=e(t.accessories)),t})}(e.cartItems),e}catch(e){throw Error("Error deserializing cart")}}let f1=e=>{try{return e.map(e=>{let{imageURL:t,accessories:n}=e,r=fY(e,["imageURL","accessories"]),i=Object.assign({},r);return t&&(i.imageURL=t.href),n&&(i.accessories=f1(n)),i})}catch(e){throw Error("Error serializing cart items")}};function f2(e){if(!e.id)throw Error("cartItem.id must not be empty");if(!e.name)throw Error("cartItem.name must not be empty");(function(e){if("number"!=typeof e||e<0)throw Error(`price ${e} must be a number not less than 0`);if(parseFloat(e.toFixed(3))!==e)throw Error(`price ${e} must have at most 3 decimal places`)})(e.price),function(e){if("number"!=typeof e||e<=0||parseInt(e.toString())!==e)throw Error(`quantity ${e} must be an integer greater than 0`)}(e.quantity)}function f3(e){if(null!=e){if(!e)throw Error("id must not be empty");if(!1===rm(e))throw Error("id must be a valid UUID")}}let f6={majorVersion:1,minorVersion:1};function f5(){if(ic(rz,eI.content,eI.task),!f7())throw rh;return a0(rH("v2","marketplace.getCart"),"marketplace.getCart",f6).then(f0)}function f8(e){if(ic(rz,eI.content,eI.task),!f7())throw rh;if(!e)throw Error("addOrUpdateCartItemsParams must be provided");return f3(null==e?void 0:e.cartId),function(e){if(!Array.isArray(e)||0===e.length)throw Error("cartItems must be a non-empty array");for(let t of e)f2(t),function(e){if(null!=e){if(!Array.isArray(e)||0===e.length)throw Error("CartItem.accessories must be a non-empty array");for(let t of e){if(t.accessories)throw Error("Item in CartItem.accessories cannot have accessories");f2(t)}}}(t.accessories)}(null==e?void 0:e.cartItems),a0(rH("v2","marketplace.addOrUpdateCartItems"),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},e),{cartItems:f1(e.cartItems),cartVersion:f6})).then(f0)}function f4(e){if(ic(rz,eI.content,eI.task),!f7())throw rh;if(!e)throw Error("removeCartItemsParams must be provided");if(f3(null==e?void 0:e.cartId),!Array.isArray(null==e?void 0:e.cartItemIds)||0===(null==e?void 0:e.cartItemIds.length))throw Error("cartItemIds must be a non-empty array");return a0(rH("v2","marketplace.removeCartItems"),"marketplace.removeCartItems",Object.assign(Object.assign({},e),{cartVersion:f6})).then(f0)}function f9(e){if(ic(rz,eI.content,eI.task),!f7())throw rh;if(!e)throw Error("updateCartStatusParams must be provided");return f3(null==e?void 0:e.cartId),function(e){if(!Object.values(ty).includes(e))throw Error(`cartStatus ${e} is not valid`)}(null==e?void 0:e.cartStatus),a0(rH("v2","marketplace.updateCartStatus"),"marketplace.updateCartStatus",Object.assign(Object.assign({},e),{cartVersion:f6})).then(f0)}function f7(){return!(!ic(rz)||!rz.supports.marketplace)}(eb=tw||(tw={})).TACAdminUser="TACAdminUser",eb.TeamsAdminUser="TeamsAdminUser",eb.TeamsEndUser="TeamsEndUser",(eS=ty||(ty={})).Open="Open",eS.Processing="Processing",eS.Processed="Processed",eS.Closed="Closed",eS.Error="Error"})(),o})()},882702:function(e,t,n){e.exports=function(){"use strict";function e(e){return"function"==typeof e}var t,r,i,o,a=void 0,s=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},l=0,u=void 0,c=void 0,d=function(e,t){w[l]=e,w[l+1]=t,2===(l+=2)&&(c?c(y):C())},f="undefined"!=typeof window?window:void 0,p=f||{},g=p.MutationObserver||p.WebKitMutationObserver,m="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"===({}).toString.call(process),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function v(){var e=setTimeout;return function(){return e(y,1)}}var w=Array(1e3);function y(){for(var e=0;e<l;e+=2)(0,w[e])(w[e+1]),w[e]=void 0,w[e+1]=void 0;l=0}var C=void 0;function b(e,t){var n=this,r=new this.constructor(E);void 0===r[A]&&D(r);var i=n._state;if(i){var o=arguments[i-1];d(function(){return N(i,r,o,n._result)})}else k(n,r,e,t);return r}function S(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(E);return P(t,e),t}m?C=function(){return process.nextTick(y)}:g?(t=0,r=new g(y),i=document.createTextNode(""),r.observe(i,{characterData:!0}),C=function(){i.data=t=++t%2}):h?((o=new MessageChannel).port1.onmessage=y,C=function(){return o.port2.postMessage(0)}):C=void 0===f?function(){try{var e=Function("return this")().require("vertx");return u=e.runOnLoop||e.runOnContext,void 0!==u?function(){u(y)}:v()}catch(e){return v()}}():v();var A=Math.random().toString(36).substring(2);function E(){}var I=void 0;function T(t,n,r){n.constructor===t.constructor&&r===b&&n.constructor.resolve===S?1===n._state?R(t,n._result):2===n._state?F(t,n._result):k(n,void 0,function(e){return P(t,e)},function(e){return F(t,e)}):void 0===r?R(t,n):e(r)?d(function(e){var t=!1,i=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(r,n,function(r){t||(t=!0,n!==r?P(e,r):R(e,r))},function(n){t||(t=!0,F(e,n))},"Settle: "+(e._label||" unknown promise"));!t&&i&&(t=!0,F(e,i))},t):R(t,n)}function P(e,t){if(e===t)F(e,TypeError("You cannot resolve a promise with itself"));else if(n=typeof t,null!==t&&("object"===n||"function"===n)){var n,r=void 0;try{r=t.then}catch(t){F(e,t);return}T(e,t,r)}else R(e,t)}function O(e){e._onerror&&e._onerror(e._result),M(e)}function R(e,t){e._state===I&&(e._result=t,e._state=1,0!==e._subscribers.length&&d(M,e))}function F(e,t){e._state===I&&(e._state=2,e._result=t,d(O,e))}function k(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+1]=n,i[o+2]=r,0===o&&e._state&&d(M,e)}function M(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?N(n,r,i,o):i(o);e._subscribers.length=0}}function N(t,n,r,i){var o=e(r),a=void 0,s=void 0,l=!0;if(o){try{a=r(i)}catch(e){l=!1,s=e}if(n===a)return void F(n,TypeError("A promises callback cannot return that same promise."))}else a=i;n._state!==I||(o&&l?P(n,a):!1===l?F(n,s):1===t?R(n,a):2===t&&F(n,a))}var x=0;function D(e){e[A]=x++,e._state=void 0,e._result=void 0,e._subscribers=[]}var U=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(E),this.promise[A]||D(this.promise),s(t)?(this.length=t.length,this._remaining=t.length,this._result=Array(this.length),0===this.length?R(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&R(this.promise,this._result))):F(this.promise,Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===I&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===S){var i=void 0,o=void 0,a=!1;try{i=e.then}catch(e){a=!0,o=e}if(i===b&&e._state!==I)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===L){var s=new n(E);a?F(s,o):T(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===I&&(this._remaining--,2===e?F(r,n):this._result[t]=n),0===this._remaining&&R(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;k(e,void 0,function(e){return n._settledAt(1,t,e)},function(e){return n._settledAt(2,t,e)})},e}(),L=function(){function t(e){this[A]=x++,this._result=this._state=void 0,this._subscribers=[],E!==e&&("function"!=typeof e&&function(){throw TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t(function(t){P(e,t)},function(t){F(e,t)})}catch(t){F(e,t)}}(this,e):function(){throw TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})}):this.then(t,t)},t}();return L.prototype.then=b,L.all=function(e){return new U(this,e).promise},L.race=function(e){var t=this;return new t(s(e)?function(n,r){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(n,r)}:function(e,t){return t(TypeError("You must pass an array to race."))})},L.resolve=S,L.reject=function(e){var t=new this(E);return F(t,e),t},L._setScheduler=function(e){c=e},L._setAsap=function(e){d=e},L._asap=d,L.polyfill=function(){var e=void 0;if(void 0!==n.g)e=n.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=L},L.Promise=L,L}()},27159:function(e,t,n){"use strict";var r=n(185230);(0,r.x)()?(0,r.J)().then(()=>{n(170823)}):n(170823)},170823:function(e,t,n){"use strict";let r,i;n.r(t),n.d(t,{teamsSdk:function(){return g},teamsSdkInitializedPromise:function(){return h}});var o,a,s,l,u,c,d,f,p,g=n(857667);window.performance&&"function"==typeof window.performance.measure&&window.performance.measure("initializeSdk");let m=["https://whiteboard.office.com","https://app.int.whiteboard.microsoft.com","https://local.assignments.onenote.com","https://local.assignments.office.com:8080","https://mobile-ui.eduauto.org"],h=new Promise((e,t)=>{r=e,i=t}),v=null!=(f=null==(l=window.UIConfiguration)||null==(s=l.ecs)||null==(a=s.configurations)?void 0:a.delayAppInitializationMs)?f:0,w=null!=(p=null==(d=window.UIConfiguration)||null==(c=d.ecs)||null==(u=c.configurations)?void 0:u.delayAppInitializationPlatforms)?p:[],y=(o=window.location.href)?(o=0===o.indexOf("?")?o.substring(1):o).split("&").reduce((e,t)=>{let n=t.indexOf("=");return -1===n?e[decodeURIComponent(t)]=void 0:e[decodeURIComponent(t.substr(0,n))]=t.substr(n+1)&&decodeURIComponent(t.substr(n+1)),e},Object.create(null)):Object.create(null),C="true"===String(y.isTeamsFrame).toLowerCase(),b="true"===String(y.isInsideTaskModule).toLowerCase(),S=String(y.hostClientType).toLowerCase(),A=0,E=()=>{g.app.initialize(m).then(()=>{window.performance&&"function"==typeof window.performance.measure&&window.performance.measure("sdkInitialized"),window.msEduTeamsInitialized=!0,window.environmentMetadata={},A>0&&(window.initFailureMetadata={delayMs:v,retries:A}),r(!0)}).catch(e=>{window.initFailureError=e,(C||b)&&A<20?(A++,setTimeout(()=>{g.app._uninitialize(),E()},100)):(C||b)&&i(e)})};-1!==w.indexOf(S)?setTimeout(()=>{E()},v):E()},185230:function(e,t,n){"use strict";n.d(t,{J:function(){return o},x:function(){return i}});let r=window;function i(){return a()||s()||l()||u()}function o(e=r){if(!e.msEduPolyfillPromise){let t=[];n(882702).polyfill(),a(e)&&t.push(n.e("97458").then(n.t.bind(n,181486,23))),s(e)&&t.push(n.e("58014").then(n.t.bind(n,966337,23))),l(e)&&t.push(n.e("49243").then(n.bind(n,391033)).then(e=>{window.ResizeObserver=e.default})),u(e)&&(e.msEduProxyMissing=!0),e.msEduPolyfillPromise=Promise.all(t)}return e.msEduPolyfillPromise}function a(e=r){return[e.Set,e.Map,e.URL,e.URLSearchParams,e.Array&&e.Array.from,e.Object&&e.Object.assign,e.Object&&e.Object.values,e.String&&e.String.prototype.endsWith,e.Promise&&e.Promise.prototype.finally].some(e=>!e)}function s(e=r){return!e.IntersectionObserver}function l(e=r){return!e.ResizeObserver}function u(e=r){return!e.Reflect||!e.Proxy}}},function(e){e(e.s=27159)}]);
//# sourceMappingURL=sdk-teams-b8d0320a46e85865-b8d0320a46e85865.map